<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="{{ csrf_token }}">
    <title>Share Opportunity - Youth Opportunities</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flag-icons/6.6.6/css/flag-icons.min.css">
    <style>
        :root {
            --primary: #16B2DC;
            --primary-dark: #0E8FB7;
            --secondary: #1E27CE;
            --dark: #140808;
            --light: #F7F7F7;
            --gray: rgba(20, 8, 8, 0.7);
            --light-gray: rgba(20, 8, 8, 0.23);
            --border: 1px solid rgba(0, 0, 0, 0.18);
            --active-color: #FFD700;
            --bg-color: #F7F7F7;
            --text-color: #140808;
            --card-bg: white;
            --footer-bg: rgba(20, 8, 8, 0.8);
            --footer-bottom-bg: #16B2DC;
        }
        
        .dark-theme {
            --bg-color: #140808;
            --text-color: #F7F7F7;
            --card-bg: #222;
            --light: #222;
            --dark: #F7F7F7;
            --footer-bg: #222;
            --footer-bottom-bg: #0E8FB7;
            --gray: rgba(247, 247, 247, 0.7);
            --light-gray: rgba(247, 247, 247, 0.23);
            --header-bg: #1a1a1a;
            --header-border: #333;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            transition: all 0.3s ease;
            padding-top: 180px;
        }
        
        h1, h2, h3, h4, h5, h6 { font-family: 'Open Sans', sans-serif; font-weight: 700; line-height: 1.3; }
        p { font-size: 1rem; line-height: 1.6; margin-bottom: 1rem; }
        .container { max-width: 1920px; margin: 0 auto; position: relative; }
        
        /* Header Styles */
        .header-container { width: 100%; margin: 0 auto; background: var(--bg-color); position: fixed; top: 0; left: 0; z-index: 1000; transition: all 0.3s ease; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .dark-theme .header-container { background: var(--header-bg); border-bottom: 1px solid var(--header-border); box-shadow: 0 2px 10px rgba(0,0,0,0.3); }
        .top-bar { height: 100px; display: flex; align-items: center; max-width: 1200px; margin: 0 auto; padding: 0 20px; background: var(--bg-color); position: relative; }
        .dark-theme .top-bar { background: var(--header-bg); }
        .logo-container { height: 80px; transition: transform 0.3s ease; display: flex; align-items: center; margin-left: 0; padding-left: 0; }
        .logo { height: 100%; width: auto; max-height: 80px; object-fit: contain; }
        .logo-container:hover { transform: scale(1.03); }
        .donate-btn { background: #FF6B6B; color: white; padding: 10px 25px; border-radius: 6px; font-weight: 600; text-decoration: none; display: flex; align-items: center; transition: all 0.3s ease; position: absolute; right: 20px; font-size: 0.9rem; }
        .donate-btn:hover { background: #FF5252; transform: translateY(-2px); }
        .donate-btn i { margin-right: 8px; }
        .upper-header-container { background: var(--bg-color); border-bottom: var(--border); width: 100%; }
        .dark-theme .upper-header-container { background: var(--header-bg); border-bottom: 1px solid var(--header-border); }
        .upper-header { height: 60px; background: var(--bg-color); display: flex; align-items: center; max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        .dark-theme .upper-header { background: var(--header-bg); }
        .date { font-family: 'Open Sans', sans-serif; font-size: 1rem; line-height: 1.5; margin-right: auto; color: var(--text-color); }
        .btn { display: inline-flex; align-items: center; justify-content: center; padding: 8px 16px; border-radius: 8px; font-family: 'Open Sans', sans-serif; font-size: 0.9rem; line-height: 1.25; cursor: pointer; transition: all 0.3s ease; margin-left: 15px; text-decoration: none; }
        .btn i { margin-right: 8px; font-size: 0.8rem; }
        .btn-outline { border: 1px solid var(--primary); background: transparent; color: var(--text-color); }
        .btn-outline:hover { background: var(--primary); color: white; }
        .btn-solid { background: var(--primary); color: white; border: 1px solid var(--primary); }
        .btn-solid:hover { background: var(--primary-dark); }
        .social-icons { display: flex; gap: 12px; margin-left: 25px; }
        .social-icon { width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; background-color: var(--primary); transition: all 0.3s ease; font-size: 0.875rem; text-decoration: none; }
        .social-icon:hover { transform: translateY(-3px); background-color: var(--primary-dark); text-decoration: none; }
        .main-header-container { background: var(--primary); width: 100%; padding: 0; transition: all 0.3s ease; }
        .dark-theme .main-header-container { background: var(--header-bg); border-bottom: 1px solid var(--header-border); }
        .main-header { height: auto; display: flex; flex-direction: column; justify-content: center; max-width: 1200px; margin: 0 auto; padding: 5px 20px; }
        .main-nav, .secondary-nav { display: flex; justify-content: space-between; width: 100%; flex-wrap: wrap; }
        .main-nav { margin-bottom: 5px; }
        .secondary-nav { margin-bottom: 5px; }
        .nav-link { color: var(--light); text-decoration: none; font-size: 0.875rem; line-height: 1; white-space: nowrap; position: relative; padding: 8px 12px; transition: all 0.3s ease; margin: 2px 0; border-radius: 4px; font-family: 'Open Sans', sans-serif; }
        .dark-theme .nav-link { color: var(--text-color); }
        .nav-link.active { background-color: var(--active-color); color: #000; font-weight: 600; }
        .nav-link:hover { transform: translateY(-2px); text-decoration: none; background-color: rgba(255, 215, 0, 0.2); }
        .dark-theme .nav-link:hover { background-color: rgba(255, 215, 0, 0.3); }
        .nav-link::after { content: ''; position: absolute; bottom: 0; left: 12px; width: 0; height: 2px; background: var(--active-color); transition: width 0.3s ease; }
        .nav-link:hover::after { width: calc(100% - 24px); }
        
        /* Main Content */
        .main-content-container { width: 100%; max-width: 1200px; margin: 20px auto; padding: 0 20px; display: flex; }
        .content-main { flex: 1; margin-right: 20px; }
        .content-sidebar { width: 300px; }
        
        /* Hero Section */
        .hero-section { position: relative; margin-bottom: 40px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .dark-theme .hero-section { box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .hero-carousel { position: relative; height: 500px; overflow: hidden; }
        .hero-carousel-inner { display: flex; height: 100%; transition: transform 0.5s ease; }
        .hero-slide { min-width: 100%; height: 100%; position: relative; background-size: cover; background-position: center; background-repeat: no-repeat; }
        .hero-slide::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(to bottom, rgba(0,0,0,0.2) 0%, rgba(0,0,0,0.8) 100%); }
        .hero-slide-content { position: absolute; bottom: 0; left: 0; width: 100%; padding: 30px; color: white; z-index: 2; background: linear-gradient(transparent, rgba(0,0,0,0.8)); }
        .hero-slide-title { font-size: 1.8rem; font-weight: 700; margin-bottom: 10px; text-shadow: 0 2px 4px rgba(0,0,0,0.5); }
        .hero-slide-meta { display: flex; gap: 15px; margin-bottom: 15px; font-size: 0.9rem; }
        .hero-slide-meta span { display: flex; align-items: center; }
        .hero-slide-meta i { margin-right: 5px; color: var(--active-color); }
        .news-ticker { position: absolute; bottom: 0; left: 0; right: 0; height: 32px; background: rgba(0,0,0,0.85); display: flex; align-items: center; overflow: hidden; z-index: 3; }
        .ticker-label { background: rgba(22, 178, 220, 0.7); color: white; padding: 0 12px; height: 100%; display: flex; align-items: center; font-weight: 600; font-size: 0.75rem; white-space: nowrap; }
        .ticker-content { flex: 1; height: 100%; display: flex; align-items: center; overflow: hidden; position: relative; }
        .ticker-text { color: white; font-size: 0.8rem; white-space: nowrap; animation: scroll-ticker 30s linear infinite; }
        @keyframes scroll-ticker { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }
        .hero-slide-badge { position: absolute; top: 20px; right: 20px; background: var(--primary); color: white; padding: 8px 15px; border-radius: 20px; font-size: 0.8rem; font-weight: 600; text-transform: uppercase; z-index: 2; }
        .hero-slide-featured { position: absolute; top: 20px; left: 20px; color: var(--active-color); font-size: 1.5rem; z-index: 2; }
        .hero-nav { position: absolute; top: 50%; transform: translateY(-50%); width: 100%; display: flex; justify-content: space-between; padding: 0 15px; z-index: 2; }
        .hero-nav-btn { width: 40px; height: 40px; border-radius: 50%; background: rgba(255,255,255,0.3); color: white; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.3s ease; border: none; font-size: 1.2rem; }
        .hero-nav-btn:hover { background: rgba(255,255,255,0.5); }
        .hero-indicators { position: absolute; top: 20px; right: 20px; display: flex; gap: 10px; z-index: 2; }
        .hero-indicator { width: 12px; height: 12px; border-radius: 50%; background: rgba(255,255,255,0.5); cursor: pointer; transition: all 0.3s ease; }
        .hero-indicator.active { background: white; transform: scale(1.2); }
        
        /* Horizontal Ad Cards */
        .horizontal-ads { display: flex; gap: 15px; margin-bottom: 30px; flex-wrap: wrap; }
        .horizontal-ad-card { flex: 1; min-width: 200px; background: var(--card-bg); padding: 15px; border: 2px dashed var(--primary); display: flex; flex-direction: column; align-items: center; text-align: center; transition: all 0.3s ease; }
        .horizontal-ad-card:hover { transform: translateY(-5px); box-shadow: 0 8px 20px rgba(0,0,0,0.15); border-color: var(--primary-dark); }
        .horizontal-ad-icon { font-size: 1.5rem; color: var(--primary); margin-bottom: 10px; }
        .horizontal-ad-title { font-size: 0.9375rem; font-weight: 700; color: var(--primary); margin-bottom: 8px; }
        .horizontal-ad-text { font-size: 0.8125rem; color: var(--gray); margin-bottom: 12px; line-height: 1.4; }
        .horizontal-ad-btn { background: var(--primary); color: white; border: none; padding: 6px 12px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; font-size: 0.75rem; width: 100%; max-width: 120px; }
        .horizontal-ad-btn:hover { background: var(--primary-dark); }
        
        /* Opportunity Cards */
        .opportunity-card { background: var(--card-bg); overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.1); transition: transform 0.3s ease, box-shadow 0.3s ease; margin-bottom: 30px; width: 285px; display: flex; flex-direction: column; border: 1px solid var(--light-gray); position: relative; }
        .dark-theme .opportunity-card { border: 1px solid var(--header-border); }
        .opportunity-card:hover { transform: translateY(-5px); box-shadow: 0 8px 20px rgba(0,0,0,0.15); }
        .opportunity-image { height: 180px; background-size: cover; background-position: center; position: relative; }
        .opportunity-badge { position: absolute; top: 10px; right: 10px; background: var(--primary); color: white; padding: 4px 8px; font-size: 0.6875rem; font-weight: 600; text-transform: uppercase; }
        .opportunity-featured { position: absolute; top: 10px; left: 10px; color: var(--active-color); font-size: 1.2rem; z-index: 1; }
        .opportunity-status { position: absolute; top: 0; right: 0; display: flex; flex-direction: column; align-items: center; z-index: 2; }
        .status-icon { font-size: 1rem; margin-bottom: 2px; }
        .status-text { font-size: 0.6rem; font-weight: 600; text-transform: uppercase; }
        .status-expired { color: #e74c3c; }
        .status-active { color: #27ae60; }
        .status-rolling { color: #3498db; }
        .status-ongoing { color: #f39c12; }
        .status-not_specified { color: #9b59b6; }
        .status-no_deadline { color: #34495e; }
        .opportunity-content { padding: 15px; flex-grow: 1; display: flex; flex-direction: column; }
        .opportunity-title { font-size: 1rem; font-weight: 600; margin-bottom: 8px; color: var(--text-color); line-height: 1.4; font-family: 'Open Sans', sans-serif; position: relative; padding-right: 60px; }
        .opportunity-meta { display: flex; flex-wrap: wrap; align-items: center; margin-bottom: 12px; font-size: 0.8125rem; color: var(--gray); gap: 10px; }
        .opportunity-meta i { margin-right: 5px; color: var(--primary); font-size: 0.75rem; }
        .opportunity-meta span { display: flex; align-items: center; }
        .opportunity-deadline { background: var(--light); padding: 8px 12px; font-size: 0.75rem; display: flex; justify-content: space-between; align-items: center; color: var(--text-color); margin-top: auto; }
        .dark-theme .opportunity-deadline { background: var(--header-bg); }
        .deadline-label { font-weight: 600; color: #e74c3c; }
        .deadline-date { font-weight: 500; }
        .opportunity-organization { display: flex; align-items: center; margin-top: 12px; padding-top: 12px; border-top: 1px solid var(--light-gray); }
        .dark-theme .opportunity-organization { border-top: 1px solid var(--header-border); }
        .org-logo { width: 40px; height: 40px; border-radius: 50%; background: #f1f1f1; margin-right: 10px; overflow: hidden; display: flex; align-items: center; justify-content: center; }
        .dark-theme .org-logo { background: #333; }
        .org-logo img { max-width: 100%; max-height: 100%; object-fit: cover; }
        .org-name { font-size: 0.8125rem; color: var(--gray); font-weight: 500; }
        
        /* Grid and Sections */
        .opportunities-grid { display: grid; grid-template-columns: repeat(3, 285px); gap: 20px; margin: 30px 0; padding: 0; justify-content: space-between; }
        .section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding: 0 0 10px 0; border-bottom: 2px solid var(--primary); }
        .section-title { font-size: 1.5rem; font-weight: 700; color: var(--primary); }
        .view-all { color: var(--primary); font-weight: 600; text-decoration: none; display: flex; align-items: center; font-size: 0.875rem; }
        .view-all i { margin-left: 5px; font-size: 0.75rem; }

        /* Sidebar */
        .sidebar-card { background: var(--card-bg); border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); padding: 20px; margin-bottom: 20px; border: 1px solid var(--light-gray); }
        .dark-theme .sidebar-card { border: 1px solid var(--header-border); }
        .sidebar-title { font-size: 1.125rem; font-weight: 700; color: var(--primary); margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid var(--light-gray); }
        .dark-theme .sidebar-title { border-bottom: 1px solid var(--header-border); }
        .search-box { position: relative; margin-bottom: 20px; }
        .search-input { width: 100%; padding: 10px 15px; border: 1px solid var(--light-gray); border-radius: 6px; font-family: 'Poppins', sans-serif; font-size: 0.875rem; padding-right: 40px; background: var(--card-bg); color: var(--text-color); }
        .search-btn { position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: transparent; border: none; color: var(--primary); cursor: pointer; }
        .language-select, .theme-select { width: 100%; padding: 8px 12px; border: 1px solid var(--light-gray); border-radius: 6px; font-family: 'Poppins', sans-serif; font-size: 0.875rem; background-color: var(--card-bg); color: var(--text-color); cursor: pointer; margin-bottom: 15px; }
        
        /* Footer */
        .back-to-top-container { width: 100%; display: flex; justify-content: center; margin: 32px 0; }
        .back-to-top { display: inline-flex; align-items: center; justify-content: center; padding: 10px 15px; min-width: 136px; height: 38px; border: 1px solid rgba(22, 178, 220, 0.36); background: transparent; color: rgba(22, 178, 220, 0.88); font-weight: 400; font-size: 1.125rem; line-height: 1.125rem; cursor: pointer; transition: all 0.3s ease; white-space: nowrap; font-family: 'Open Sans', sans-serif; }
        .back-to-top:hover { background: rgba(22, 178, 220, 0.1); border-color: rgba(22, 178, 220, 0.8); color: rgba(22, 178, 220, 1); }
        .back-to-top i { margin-right: 8px; }
        .footer { width: 100%; background: var(--footer-bg); padding: 45px 0 0; }
        .footer-content { width: 100%; max-width: 1200px; margin: 0 auto; padding: 0 20px; display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 40px; }
        .footer-section { margin-bottom: 30px; }
        .footer-section:first-child { display: flex; align-items: center; justify-content: flex-start; padding-left: 0; margin-left: 0; }
        .footer-section h3 { font-weight: 700; font-size: 1.25rem; line-height: 1.25rem; color: #FFFFFF; margin-bottom: 1.5rem; font-family: 'Open Sans', sans-serif; }
        .footer-section p { font-weight: 400; font-size: 0.9375rem; line-height: 1.5; color: rgba(255,255,255,0.8); margin-bottom: 1rem; font-family: 'Poppins', sans-serif; }
        .footer-logo { height: 150px; transition: transform 0.3s ease; display: flex; align-items: center; justify-content: flex-start; margin-left: 0; padding-left: 0; }
        .footer-logo img { height: 100%; width: auto; max-height: 150px; object-fit: contain; }
        .footer-logo:hover { transform: scale(1.03); }
        .social-links { display: flex; flex-direction: column; gap: 12px; }
        .social-link { display: flex; align-items: center; gap: 15px; color: #FFFFFF; text-decoration: none; font-weight: 600; font-size: 1rem; line-height: 1; letter-spacing: 0.02em; transition: all 0.3s ease; font-family: 'Poppins', sans-serif; }
        .social-link i { width: 25px; height: 25px; display: flex; align-items: center; justify-content: center; font-size: 1.25rem; }
        .social-link:hover { color: #FFD700; transform: translateX(5px); }
        .footer-btn { display: inline-flex; justify-content: center; align-items: center; padding: 12px 20px; background: #16B2DC; color: #FFFFFF; text-decoration: none; font-weight: 600; font-size: 0.9375rem; line-height: 1; border: none; cursor: pointer; transition: all 0.3s ease; border-radius: 0; font-family: 'Open Sans', sans-serif; margin-top: 10px; }
        .footer-btn:hover { background: #0E8FB7; transform: translateY(-2px); }
        .footer-btn-feedback { background: #fff; color: #16B2DC; border: 2px solid #16B2DC; width: 160px; }
        .footer-btn-feedback:hover { background: #16B2DC; color: #fff; }
        .footer-btn-learn-more { width: 160px; }
        .footer-bottom { width: 100%; background: var(--footer-bottom-bg); padding: 20px 0; }
        .footer-bottom-content { width: 100%; max-width: 1200px; margin: 0 auto; padding: 0 20px; display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; gap: 20px; }
        .footer-bottom p { font-weight: 400; font-size: 0.875rem; line-height: 1.5; color: #FFFFFF; font-family: 'Poppins', sans-serif; }
        .footer-bottom i { margin-right: 5px; }
        
        /* Modal Styles */
        .language-modal, .search-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: flex; justify-content: center; align-items: center; z-index: 9999; opacity: 0; visibility: hidden; transition: all 0.3s ease; }
        .language-modal.show, .search-modal.show { opacity: 1; visibility: visible; }
        .modal-content { background: var(--card-bg); border-radius: 12px; max-width: 500px; width: 90%; max-height: 80vh; display: flex; flex-direction: column; box-shadow: 0 10px 30px rgba(0,0,0,0.3); transform: scale(0.7); transition: transform 0.3s ease; }
        .language-modal.show .modal-content, .search-modal.show .modal-content { transform: scale(1); }
        .modal-header { display: flex; justify-content: space-between; align-items: center; padding: 20px; border-bottom: 1px solid var(--light-gray); }
        .modal-header h3 { margin: 0; color: var(--text-color); }
        .modal-close { background: none; border: none; font-size: 24px; cursor: pointer; color: var(--gray); transition: color 0.3s ease; }
        .modal-close:hover { color: var(--text-color); }
        .language-options { padding: 20px; }
        .lang-option { display: flex; align-items: center; gap: 12px; padding: 12px; border-radius: 8px; cursor: pointer; transition: all 0.3s ease; margin-bottom: 8px; }
        .lang-option:hover { background: var(--primary); color: white; }
        .search-form { padding: 20px; display: flex; gap: 10px; }
        .modal-search-input { flex: 1; padding: 12px; border: 1px solid var(--light-gray); border-radius: 6px; font-size: 16px; background: var(--card-bg); color: var(--text-color); }
        .modal-search-btn { background: var(--primary); color: white; border: none; padding: 12px 20px; border-radius: 6px; cursor: pointer; transition: background 0.3s ease; }
        .modal-search-btn:hover { background: var(--primary-dark); }
        .search-results { padding: 0 20px 20px; overflow-y: auto; flex: 1; max-height: 400px; }
        
        @media (max-width: 768px) {
            .modal-content {
                max-width: 95%;
                max-height: 85vh;
            }
            
            .search-results {
                max-height: 300px;
            }
            
            .form-row {
                grid-template-columns: 1fr !important;
            }
        }
        .search-result-item { padding: 15px; border: 1px solid var(--light-gray); border-radius: 8px; margin-bottom: 10px; cursor: pointer; transition: all 0.3s ease; }
        .search-result-item:hover { background: var(--light); transform: translateY(-2px); }
        .search-result-item h5 { margin-bottom: 5px; color: var(--primary); }
        .search-result-item p { color: var(--gray); font-size: 0.9rem; margin: 0; }
        
        /* Mobile Header */
        .mobile-header { display: none; align-items: center; height: 80px; padding: 0 15px; justify-content: space-between; }
        .mobile-header .date { font-size: 0.75rem; color: var(--text-color); flex: 1; }
        .mobile-header .logo-container { height: 50px; position: absolute; left: 50%; transform: translateX(-50%); }
        .mobile-header .logo { height: 100%; width: auto; object-fit: contain; }
        .mobile-header .nav-toggle { background: var(--primary); color: white; border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 1rem; margin-left: auto; }
        
        /* Navigation Menu */
        .nav-menu { position: fixed; top: 80px; left: -100%; width: 320px; height: calc(100vh - 80px); background: var(--card-bg); transition: left 0.3s ease; overflow-y: auto; box-shadow: 2px 0 10px rgba(0,0,0,0.1); z-index: 999; -webkit-overflow-scrolling: touch; padding-bottom: 100px; }
        .nav-menu-content { padding: 20px; min-height: 100%; padding-bottom: 150px; padding-top: 30px; }
        .mobile-social-icons { display: flex; justify-content: center; gap: 15px; margin-bottom: 25px; margin-top: 5px; padding-bottom: 20px; border-bottom: 1px solid var(--light-gray); }
        .mobile-social-icon { width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; background-color: var(--primary); transition: all 0.3s ease; font-size: 1rem; text-decoration: none; }
        .mobile-social-icon:hover { transform: translateY(-3px); background-color: var(--primary-dark); }
        .nav-menu.active { left: 0; }
        .nav-section { margin-bottom: 25px; }
        .nav-section h3 { color: var(--primary); font-size: 1.1rem; margin-bottom: 15px; padding-bottom: 8px; border-bottom: 1px solid var(--light-gray); }
        .nav-menu .nav-link { display: block; color: var(--text-color); text-decoration: none; padding: 14px 15px; margin-bottom: 8px; border-radius: 6px; transition: all 0.3s ease; font-size: 0.95rem; font-weight: 500; }
        .nav-menu .nav-link:hover { background: var(--primary); color: white; transform: translateX(5px); }
        .nav-menu .nav-link.active { background: var(--active-color); color: #000; font-weight: 600; }
        
        /* Mobile Bottom Navigation */
        .mobile-bottom-nav { display: none; position: fixed; bottom: 0; left: 0; width: 100%; background: var(--card-bg); border-top: 1px solid var(--light-gray); padding: 10px 0; z-index: 1000; }
        .bottom-nav-items { display: flex; justify-content: space-around; align-items: center; }
        .bottom-nav-item { display: flex; flex-direction: column; align-items: center; text-decoration: none; color: var(--gray); transition: all 0.3s ease; padding: 5px; }
        .bottom-nav-item i { font-size: 1.2rem; margin-bottom: 4px; }
        .bottom-nav-item span { font-size: 0.7rem; font-weight: 500; }
        .bottom-nav-item:hover, .bottom-nav-item.active { color: var(--primary); transform: translateY(-2px); }
        .bottom-nav-item.donate { color: #FF6B6B; }
        .bottom-nav-item.donate:hover { color: #FF5252; }
        
        /* Overlay */
        .nav-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 998; opacity: 0; visibility: hidden; transition: all 0.3s ease; }
        .nav-overlay.active { opacity: 1; visibility: visible; }
        
        /* Responsive Design */
        @media (max-width: 1000px) {
            .opportunities-grid { grid-template-columns: repeat(2, 285px); justify-content: space-around; }
            .horizontal-ads { flex-direction: column; }
            .horizontal-ad-card { min-width: 100%; }
        }
        
        @media (min-width: 769px) {
            .mobile-header { display: none !important; }
            .mobile-bottom-nav { display: none !important; }
            .nav-menu { display: none !important; }
        }
        
        @media (max-width: 768px) {
            body { padding-top: 100px !important; padding-bottom: 70px; }
            .footer-bottom-content { justify-content: center; text-align: center; }
            .footer-bottom-content p:nth-child(3) { order: 2; width: 100%; }
            .footer-bottom-content p:nth-child(4) { order: 3; width: 100%; }
            .upper-header-container, .top-bar, .main-header-container { display: none; }
            .mobile-header { display: flex; }
            .mobile-bottom-nav { display: block; }
            .nav-menu { top: 80px; height: calc(100vh - 80px); }
            .main-content-container { flex-direction: column; margin-top: 20px; }
            .content-main { margin-right: 0; margin-bottom: 20px; }
            .content-sidebar { display: none; }
            .hero-carousel { height: 300px; }
            .opportunities-grid { grid-template-columns: repeat(2, 1fr); gap: 15px; }
            .opportunity-card { width: 100%; }
            .horizontal-ads { flex-direction: column; }
            .horizontal-ad-card { min-width: 100%; }
        }
        
        @media (max-width: 600px) {
            .opportunities-grid { grid-template-columns: 1fr; }
            .hero-carousel { height: 250px; }
        }
        
        /* Animated Shapes */
        .floating-shapes {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 1;
        }
        
        .shape {
            position: absolute;
            opacity: 0.1;
            animation: float 6s ease-in-out infinite;
        }
        
        .shape-1 {
            width: 80px;
            height: 80px;
            background: rgba(255,255,255,0.3);
            border-radius: 50%;
            top: 20%;
            left: 10%;
            animation-delay: 0s;
        }
        
        .shape-2 {
            width: 60px;
            height: 60px;
            background: rgba(255,255,255,0.2);
            transform: rotate(45deg);
            top: 60%;
            right: 15%;
            animation-delay: 1s;
        }
        
        .shape-3 {
            width: 100px;
            height: 100px;
            border: 3px solid rgba(255,255,255,0.2);
            border-radius: 50%;
            top: 10%;
            right: 20%;
            animation-delay: 2s;
        }
        
        .shape-4 {
            width: 0;
            height: 0;
            border-left: 30px solid transparent;
            border-right: 30px solid transparent;
            border-bottom: 50px solid rgba(255,255,255,0.2);
            top: 70%;
            left: 20%;
            animation-delay: 3s;
        }
        
        .shape-5 {
            width: 70px;
            height: 70px;
            background: rgba(255,255,255,0.15);
            border-radius: 20%;
            top: 30%;
            left: 70%;
            animation-delay: 4s;
        }
        
        .shape-6 {
            width: 90px;
            height: 90px;
            border: 2px solid rgba(255,255,255,0.2);
            transform: rotate(30deg);
            top: 50%;
            left: 5%;
            animation-delay: 5s;
        }
        
        @keyframes float {
            0%, 100% {
                transform: translateY(0px) rotate(0deg);
            }
            33% {
                transform: translateY(-20px) rotate(120deg);
            }
            66% {
                transform: translateY(10px) rotate(240deg);
            }
        }
        
        /* Sticky header on scroll */
        .header-container.scrolled { padding: 0; }
        .header-container.scrolled .top-bar { height: 70px; }
        .header-container.scrolled .logo-container { height: 60px; }
        .header-container.scrolled .logo { max-height: 60px; }
        .header-container.scrolled .main-header-container { position: fixed; top: 70px; width: 100%; }
    
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: var(--text-color);
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--light-gray);
            border-radius: 6px;
            font-family: 'Poppins', sans-serif;
            font-size: 14px;
            background: var(--card-bg);
            color: var(--text-color);
        }
        
        .form-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 20px;
        }
        
        .form-actions button {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .form-actions button[type="submit"] {
            background: var(--primary);
            color: white;
        }
        
        .form-actions button[type="submit"]:hover {
            background: var(--primary-dark);
        }
        
        .form-actions button[type="button"] {
            background: var(--light-gray);
            color: var(--text-color);
        }
        
        .form-actions button[type="button"]:hover {
            background: var(--gray);
            color: white;
        }
        
        .modal-body {
            padding: 20px;
        }
        
        .modal-body-scroll {
            padding: 20px;
            max-height: 60vh;
            overflow-y: auto;
        }
        
        .feedback-modal {
            max-height: 80vh;
        }
        
        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }
        </style>
    <link rel="icon" href="../static/images/youthopps-logo.png" type="image/png">
</head>
<body>
    <div class="container">
        <header class="header-container">
            <div class="upper-header-container">
                <div class="upper-header">
                    <div class="date" id="currentDate"></div>
                    <a href="#" class="btn btn-outline" id="desktopSearchBtn">
                        <i class="fas fa-search"></i>
                        <span>SEARCH</span>
                    </a>
                    <a href="../login.html" class="btn btn-solid">
                        <i class="fas fa-user"></i>
                        <span>Login/Register</span>
                    </a>
                    <div class="social-icons">
                        <a href="#" class="social-icon"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="social-icon"><i class="fab fa-linkedin-in"></i></a>
                        <a href="#" class="social-icon"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="social-icon"><i class="fab fa-youtube"></i></a>
                        <a href="#" class="social-icon"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
            </div>

            <div class="top-bar">
                <div class="logo-container">
                    <img src="../../static/images/favicon.ico.png" alt="Youth Opportunities Logo" class="logo">
                </div>
                <a href="#" class="donate-btn">
                    <i class="fas fa-heart"></i>
                    <span>DONATE NOW</span>
                </a>
            </div>
            
            <div class="main-header-container">
                <div class="main-header">
                    <nav class="main-nav">
                        <a href="home.html" class="nav-link">HOME</a>
                        <a href="internships.html" class="nav-link">INTERNSHIPS</a>
                        <a href="jobs.html" class="nav-link">JOBS</a>
                        <a href="grants.html" class="nav-link">GRANTS</a>
                        <a href="scholarships.html" class="nav-link">SCHOLARSHIPS</a>
                        <a href="fellowships.html" class="nav-link">FELLOWSHIPS</a>
                        <a href="conferences.html" class="nav-link">CONFERENCES</a>
                        <a href="workshops.html" class="nav-link">WORKSHOPS</a>
                        <a href="trainings.html" class="nav-link">TRAININGS</a>
                    </nav>
                    <nav class="secondary-nav">
                        <a href="community.html" class="nav-link">COMMUNITY</a>
                        <a href="competitions.html" class="nav-link">COMPETITIONS</a>
                        <a href="share-opportunity.html" class="nav-link active">SHARE OPPORTUNITY</a>
                        
                        <a href="services.html" class="nav-link">SERVICES</a>

                        <a href="blogs.html" class="nav-link">BLOGS</a>

                        <a href="announcements.html" class="nav-link">ANNOUNCEMENTS</a>
                        <a href="miscellaneous.html" class="nav-link">MISCELLANEOUS</a>
                    </nav>
                </div>
            </div>
            
            <!-- Mobile Header -->
            <div class="mobile-header">
                <div class="date" id="currentDateMobile"></div>
                <div class="logo-container">
                    <img src="../../static/images/favicon.ico.png" alt="Youth Opportunities Logo" class="logo">
                </div>
                <button class="nav-toggle" id="navToggleMobile">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </header>
        
        <!-- Navigation Menu -->
        <div class="nav-overlay" id="navOverlay"></div>
        <nav class="nav-menu" id="navMenu">
            <div class="nav-menu-content">
                <div class="mobile-social-icons" style="margin-top: 5px;">
                    <a href="#" class="mobile-social-icon"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" class="mobile-social-icon"><i class="fab fa-linkedin-in"></i></a>
                    <a href="#" class="mobile-social-icon"><i class="fab fa-twitter"></i></a>
                    <a href="#" class="mobile-social-icon"><i class="fab fa-youtube"></i></a>
                    <a href="#" class="mobile-social-icon"><i class="fab fa-instagram"></i></a>
                </div>
                
                <div class="nav-section">
                    <h3>Main Navigation</h3>
                    <a href="home.html" class="nav-link">HOME</a>
                    <a href="internships.html" class="nav-link">INTERNSHIPS</a>
                    <a href="jobs.html" class="nav-link">JOBS</a>
                    <a href="grants.html" class="nav-link">GRANTS</a>
                    <a href="scholarships.html" class="nav-link">SCHOLARSHIPS</a>
                    <a href="fellowships.html" class="nav-link">FELLOWSHIPS</a>
                    <a href="conferences.html" class="nav-link">CONFERENCES</a>
                    <a href="workshops.html" class="nav-link">WORKSHOPS</a>
                    <a href="trainings.html" class="nav-link">TRAININGS</a>
                </div>
                
                <div class="nav-section">
                    <h3>More Options</h3>
                    <a href="community.html" class="nav-link">COMMUNITY</a>
                    <a href="competitions.html" class="nav-link">COMPETITIONS</a>
                    <a href="share-opportunity.html" class="nav-link active">SHARE OPPORTUNITY</a>
                    
                    <a href="services.html" class="nav-link">SERVICES</a>

                        <a href="blogs.html" class="nav-link">BLOGS</a>

                        <a href="announcements.html" class="nav-link">ANNOUNCEMENTS</a>
                    <a href="miscellaneous.html" class="nav-link">MISCELLANEOUS</a>
                </div>
            </div>
        </nav>
        
        <!-- Mobile Bottom Navigation -->
        <div class="mobile-bottom-nav">
            <div class="bottom-nav-items">
                <a href="#" class="bottom-nav-item donate">
                    <i class="fas fa-heart"></i>
                    <span>Donate</span>
                </a>
                <a href="#" class="bottom-nav-item" id="searchBtn">
                    <i class="fas fa-search"></i>
                    <span>Search</span>
                </a>
                <a href="../login.html" class="bottom-nav-item">
                    <i class="fas fa-user"></i>
                    <span>Account</span>
                </a>
                <a href="#" class="bottom-nav-item" id="themeToggle">
                    <i class="fas fa-sun" id="themeIcon"></i>
                    <span>Theme</span>
                </a>
                <a href="#" class="bottom-nav-item" id="languageToggle">
                    <i class="fas fa-globe"></i>
                    <span>Language</span>
                </a>
            </div>
        </div>
        
        <div class="main-content-container">
            <div class="content-main">
                <!-- Breadcrumb -->
                <div class="breadcrumb" style="margin-bottom: 20px; padding: 10px 0; border-bottom: 1px solid var(--light-gray); font-size: 0.9rem; color: var(--gray);">
                    <a href="home.html" style="color: var(--primary); text-decoration: none;">Home</a>
                    <span style="margin: 0 8px; color: var(--gray);">Â»</span>
                    <span style="color: var(--text-color); font-weight: 500;">Share Opportunity</span>
                </div>
                
                <!-- Hero Section -->
                <section class="hero-section">
                    <div class="hero-content">
                        <!-- Welcome Card -->
                        <div class="welcome-card" style="background: var(--card-bg); border-radius: 16px; padding: 40px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); margin-bottom: 40px; border: 1px solid var(--light-gray);">
                            <div class="welcome-header" style="text-align: center; margin-bottom: 30px;">
                                <i class="fas fa-share-alt welcome-icon" style="font-size: 3rem; color: var(--primary); margin-bottom: 15px;"></i>
                                <h1 style="color: var(--primary); margin-bottom: 15px; font-size: 2.2rem;">Share an Opportunity</h1>
                            </div>
                            <div class="welcome-body">
                                <p class="welcome-text" style="text-align: center; font-size: 1.1rem; color: var(--gray); margin-bottom: 30px; line-height: 1.6;">Help others discover amazing opportunities by sharing them with our community. All submissions are reviewed before publication.</p>
                                
                                <!-- Share Opportunity Form -->
                                <form id="shareOpportunityForm" style="margin-top: 30px;">
                                    <div class="form-row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                                        <div class="form-group">
                                            <label for="opportunityType" style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-color);">Opportunity Type <span style="color: #e74c3c;">*</span></label>
                                            <select id="opportunityType" name="opportunity_type" required style="width: 100%; padding: 12px; border: 2px solid var(--light-gray); border-radius: 8px; font-family: 'Poppins', sans-serif; font-size: 14px; background: var(--card-bg); color: var(--text-color);">
                                                <option value="">Select type...</option>
                                                <option value="internship">Internship</option>
                                                <option value="job">Job</option>
                                                <option value="grant">Grant</option>
                                                <option value="scholarship">Scholarship</option>
                                                <option value="fellowship">Fellowship</option>
                                                <option value="conference">Conference</option>
                                                <option value="workshop">Workshop</option>
                                                <option value="training">Training</option>
                                                <option value="competition">Competition</option>
                                            </select>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label for="deadlineType" style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-color);">Deadline Type <span style="color: #e74c3c;">*</span></label>
                                            <select id="deadlineType" name="deadline_type" required style="width: 100%; padding: 12px; border: 2px solid var(--light-gray); border-radius: 8px; font-family: 'Poppins', sans-serif; font-size: 14px; background: var(--card-bg); color: var(--text-color);">
                                                <option value="">Select deadline type...</option>
                                                <option value="specific">Specific Date</option>
                                                <option value="ongoing">Ongoing</option>
                                                <option value="rolling">Rolling</option>
                                                <option value="not_specified">Not Specified</option>
                                                <option value="no_deadline">No Deadline</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div class="form-group" style="margin-bottom: 20px;">
                                        <label for="title" style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-color);">Opportunity Title <span style="color: #e74c3c;">*</span></label>
                                        <input type="text" id="title" name="title" required placeholder="Enter the opportunity title..." style="width: 100%; padding: 12px; border: 2px solid var(--light-gray); border-radius: 8px; font-family: 'Poppins', sans-serif; font-size: 14px; background: var(--card-bg); color: var(--text-color);">
                                    </div>
                                    
                                    <div class="form-group" style="margin-bottom: 20px;">
                                        <label for="description" style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-color);">Description <span style="color: #e74c3c;">*</span></label>
                                        <textarea id="description" name="description" required placeholder="Provide a detailed description of the opportunity..." style="width: 100%; padding: 12px; border: 2px solid var(--light-gray); border-radius: 8px; font-family: 'Poppins', sans-serif; font-size: 14px; background: var(--card-bg); color: var(--text-color); resize: vertical; min-height: 120px;"></textarea>
                                    </div>
                                    
                                    <div class="form-row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                                        <div class="form-group">
                                            <label for="organization" style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-color);">Organization</label>
                                            <input type="text" id="organization" name="organization" placeholder="Organization name..." style="width: 100%; padding: 12px; border: 2px solid var(--light-gray); border-radius: 8px; font-family: 'Poppins', sans-serif; font-size: 14px; background: var(--card-bg); color: var(--text-color);">
                                        </div>
                                        
                                        <div class="form-group">
                                            <label for="location" style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-color);">Location</label>
                                            <input type="text" id="location" name="location" placeholder="Location or 'Remote'..." style="width: 100%; padding: 12px; border: 2px solid var(--light-gray); border-radius: 8px; font-family: 'Poppins', sans-serif; font-size: 14px; background: var(--card-bg); color: var(--text-color);">
                                        </div>
                                    </div>
                                    
                                    <div class="form-group" id="deadlineGroup" style="display: none; margin-bottom: 20px;">
                                        <label for="deadline" style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-color);">Deadline Date</label>
                                        <input type="date" id="deadline" name="deadline" style="width: 100%; padding: 12px; border: 2px solid var(--light-gray); border-radius: 8px; font-family: 'Poppins', sans-serif; font-size: 14px; background: var(--card-bg); color: var(--text-color);">
                                    </div>
                                    
                                    <div class="form-group" style="margin-bottom: 20px;">
                                        <label for="opportunityLink" style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-color);">Opportunity Link <span style="color: #e74c3c;">*</span></label>
                                        <input type="url" id="opportunityLink" name="opportunity_link" required placeholder="https://..." style="width: 100%; padding: 12px; border: 2px solid var(--light-gray); border-radius: 8px; font-family: 'Poppins', sans-serif; font-size: 14px; background: var(--card-bg); color: var(--text-color);">
                                    </div>
                                    
                                    <div class="form-row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                                        <div class="form-group">
                                            <label for="featuredImage" style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-color);">Featured Image (Optional)</label>
                                            <input type="file" id="featuredImage" name="featured_image" accept="image/*" style="width: 100%; padding: 12px; border: 2px solid var(--light-gray); border-radius: 8px; font-family: 'Poppins', sans-serif; font-size: 14px; background: var(--card-bg); color: var(--text-color);">
                                        </div>
                                        
                                        <div class="form-group">
                                            <label for="organizationLogo" style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-color);">Organization Logo (Optional)</label>
                                            <input type="file" id="organizationLogo" name="organization_logo" accept="image/*" style="width: 100%; padding: 12px; border: 2px solid var(--light-gray); border-radius: 8px; font-family: 'Poppins', sans-serif; font-size: 14px; background: var(--card-bg); color: var(--text-color);">
                                        </div>
                                    </div>
                                    
                                    <div class="form-row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px;">
                                        <div class="form-group">
                                            <label for="submitterName" style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-color);">Your Name (Optional)</label>
                                            <input type="text" id="submitterName" name="submitter_name" placeholder="Your full name..." style="width: 100%; padding: 12px; border: 2px solid var(--light-gray); border-radius: 8px; font-family: 'Poppins', sans-serif; font-size: 14px; background: var(--card-bg); color: var(--text-color);">
                                        </div>
                                        
                                        <div class="form-group">
                                            <label for="submitterEmail" style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-color);">Your Email (Optional)</label>
                                            <input type="email" id="submitterEmail" name="submitter_email" placeholder="your.email@example.com" style="width: 100%; padding: 12px; border: 2px solid var(--light-gray); border-radius: 8px; font-family: 'Poppins', sans-serif; font-size: 14px; background: var(--card-bg); color: var(--text-color);">
                                        </div>
                                    </div>
                                    
                                    <button type="submit" style="background: var(--primary); color: white; border: none; padding: 15px 30px; border-radius: 10px; font-weight: 600; cursor: pointer; font-size: 1rem; width: 100%; transition: all 0.3s ease;" onmouseover="this.style.background='var(--primary-dark)'; this.style.transform='translateY(-2px)'" onmouseout="this.style.background='var(--primary)'; this.style.transform='translateY(0)'">
                                        <i class="fas fa-paper-plane" style="margin-right: 10px;"></i>
                                        Submit Opportunity for Review
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- Info Box -->
                <div style="background: rgba(22, 178, 220, 0.1); border: 1px solid rgba(22, 178, 220, 0.3); border-radius: 10px; padding: 20px; margin-bottom: 30px;">
                    <h3 style="color: var(--primary); margin-bottom: 10px;"><i class="fas fa-info-circle" style="margin-right: 10px;"></i>Submission Guidelines</h3>
                    <p style="color: var(--text-color); margin: 0; line-height: 1.6;">Please ensure the opportunity is legitimate, current, and beneficial to young professionals. Include as much detail as possible to help others understand the opportunity.</p>
                </div>
                
            </div>
            
            <div class="content-sidebar">
                <div class="sidebar-card">
                    <div class="search-box">
                        <input type="text" class="search-input" id="sidebarSearchInput" placeholder="Search opportunities...">
                        <button class="search-btn" id="sidebarSearchBtn"><i class="fas fa-search"></i></button>
                    </div>
                </div>
                
                <div class="sidebar-card">
                    <h3 class="sidebar-title">Language</h3>
                    <select class="language-select" id="languageSelector">
                        <option value="en" selected>English</option>
                        <option value="zh">ä¸­æ (Chinese)</option>
                        <option value="es">EspaÃ±ol (Spanish)</option>
                        <option value="fr">FranÃ§ais (French)</option>
                        <option value="ar">Ø§ÙØ¹Ø±Ø¨ÙØ© (Arabic)</option>
                        <option value="hi">à¤¹à¤¿à¤¨à¥à¤¦à¥ (Hindi)</option>
                        <option value="pt">PortuguÃªs (Portuguese)</option>
                        <option value="ru">Ð ÑÑÑÐºÐ¸Ð¹ (Russian)</option>
                        <option value="de">Deutsch (German)</option>
                        <option value="ja">æ¥æ¬èª (Japanese)</option>
                        <option value="sw">Kiswahili (Swahili)</option>
                    </select>
                    
                    <h3 class="sidebar-title" style="margin-top: 15px;">Theme</h3>
                    <select class="theme-select" id="themeSelector">
                        <option value="light">Light</option>
                        <option value="dark">Dark</option>
                    </select>
                </div>
            </div>
        </div>
    </div>
    <!-- Footer -->
    <div class="back-to-top-container">
        <button class="back-to-top" id="backToTopBtn">
            <i class="fas fa-arrow-up"></i> 
            <span>BACK TO TOP</span>
        </button>
    </div>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <div class="footer-logo">
                    <img src="../../static/images/Third logo.png" alt="Youth Opportunities Logo">
                </div>
            </div>

            <div class="footer-section">
                <h3>ABOUT US</h3>
                <p>Founded in 2024, Youth Opportunities Uniting Talent and Hope is a youth-led platform dedicated to sharing global opportunitiesâinternships, scholarships, fellowships, jobs, conferences, and more. We connect young talents to life-changing resources that inspire growth, exposure, and hope for a brighter future.</p>
                <div style="display: flex; flex-direction: column; gap: 15px; margin-top: 10px;">
                    <a href="aboutus.html?from=share-opportunity" class="footer-btn footer-btn-learn-more" style="text-decoration: none;">LEARN MORE</a>
                    <button class="footer-btn footer-btn-feedback">FEEDBACK</button>
                </div>
            </div>

            <div class="footer-section">
                <h3>FOLLOW US ON:</h3>
                <div class="social-links">
                    <a href="#" class="social-link">
                        <i class="fab fa-facebook-f"></i> Facebook
                    </a>
                    <a href="#" class="social-link">
                        <i class="fab fa-instagram"></i> Instagram
                    </a>
                    <a href="#" class="social-link">
                        <i class="fab fa-twitter"></i> Twitter
                    </a>
                    <a href="#" class="social-link">
                        <i class="fab fa-whatsapp"></i> Whatsapp
                    </a>
                    <a href="#" class="social-link">
                        <i class="fab fa-linkedin-in"></i> LinkedIn
                    </a>
                    <a href="#" class="social-link">
                        <i class="fab fa-telegram"></i> Telegram
                    </a>
                </div>
            </div>

            <div class="footer-section">
                <h3>NEWSLETTERS</h3>
                <p>Get the latest internships, scholarships, fellowships, jobs, and more straight to your inbox.</p>
                <button class="footer-btn">SUBSCRIBE</button>

                <h3 style="margin-top: 30px;">FREQUENTLY ASKED QUESTIONS</h3>
                <a href="faq.html?from=share-opportunity" class="footer-btn" style="padding: 5px 15px; height: 28px; font-size: 15px; text-decoration: none;">FAQ</a>
            </div>
        </div>

        <div class="footer-bottom">
            <div class="footer-bottom-content">
                <p><i class="fas fa-user"></i> Designed By: Chol Atem Giet</p>
                <p><i class="fas fa-phone"></i> Contact Us</p>
                <p>Terms of Use | Privacy Policy</p>
            </div>
        </div>
    </footer>

    <script>
        let communityStats = {
            activeMembers: 0,
            successStories: 0,
            successRate: 0
        };
        
        let communityTopics = {
            'career-advice': {
                title: 'Career Advice',
                discussions: 0,
                questions: []
            },
            'interview-tips': {
                title: 'Interview Tips',
                discussions: 0,
                questions: []
            },
            'resume-help': {
                title: 'Resume Help',
                discussions: 0,
                questions: []
            },
            'networking': {
                title: 'Networking',
                discussions: 0,
                questions: []
            },
            'success-stories': {
                title: 'Success Stories',
                discussions: 0,
                questions: []
            }
        };
        
        // Removed fetchCommunityStats function since stats section was removed
        
        async function fetchTopicStats() {
            console.log('Fetching topic stats...');
            try {
                const response = await fetch('http://127.0.0.1:8000/api/community/topics/');
                console.log('Topic stats response:', response.status);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }
                
                const data = await response.json();
                console.log('Topic stats data:', data);
                
                // Update community topics with fetched data
                Object.keys(data).forEach(topicId => {
                    if (communityTopics[topicId]) {
                        communityTopics[topicId].discussions = data[topicId].discussions || 0;
                        console.log(`Updated ${topicId}: ${data[topicId].discussions} discussions`);
                    }
                });
                
                // Update topic cards
                updateTopicCards();
                
            } catch (error) {
                console.error('Error fetching topic stats:', error);
                // Set default values to 0 and update cards
                Object.keys(communityTopics).forEach(topicId => {
                    communityTopics[topicId].discussions = 0;
                });
                updateTopicCards();
            }
        }
        
        function updateTopicCards() {
            Object.keys(communityTopics).forEach(topicId => {
                const topic = communityTopics[topicId];
                const discussionsElement = document.getElementById(`${topicId}-discussions`);
                
                if (discussionsElement) {
                    discussionsElement.textContent = topic.discussions;
                    console.log(`Updated ${topicId} display: ${topic.discussions}`);
                } else {
                    console.warn(`Element not found: ${topicId}-discussions`);
                }
            });
        }
        
        function formatOpportunity(opportunity) {
            const now = new Date();
            const deadlineType = opportunity.deadline_type || 'specific';
            const deadline = opportunity.deadline ? new Date(opportunity.deadline) : null;
            const isExpired = deadlineType === 'specific' && deadline && deadline < now;
            
            let status, statusIcon, statusText, statusColor, deadlineDisplay;
            
            if (deadlineType === 'rolling') {
                status = 'rolling';
                statusIcon = 'fa-infinity';
                statusText = 'Rolling';
                statusColor = '#3498db';
                deadlineDisplay = 'Rolling Deadline';
            } else if (deadlineType === 'ongoing') {
                status = 'ongoing';
                statusIcon = 'fa-clock';
                statusText = 'Ongoing';
                statusColor = '#f39c12';
                deadlineDisplay = 'Ongoing';
            } else if (deadlineType === 'not_specified') {
                status = 'not_specified';
                statusIcon = 'fa-question-circle';
                statusText = 'Not Specified';
                statusColor = '#9b59b6';
                deadlineDisplay = 'Not Specified';
            } else if (deadlineType === 'no_deadline') {
                status = 'no_deadline';
                statusIcon = 'fa-calendar-times';
                statusText = 'No Deadline';
                statusColor = '#34495e';
                deadlineDisplay = 'No Deadline';
            } else if (isExpired) {
                status = 'expired';
                statusIcon = 'fa-exclamation-triangle';
                statusText = 'Expired';
                statusColor = '#e74c3c';
                deadlineDisplay = deadline.toLocaleDateString();
            } else {
                status = 'active';
                statusIcon = 'fa-check-circle';
                statusText = 'Active';
                statusColor = '#27ae60';
                deadlineDisplay = deadline ? deadline.toLocaleDateString() : 'TBD';
            }
            
            return {
                id: opportunity.id,
                title: opportunity.title,
                description: opportunity.description?.replace(/<[^>]*>/g, '').substring(0, 150) + '...' || '',
                image: opportunity.featured_image ? `http://127.0.0.1:8000${opportunity.featured_image}` : 'https://images.unsplash.com/photo-1521791055366-0d553872125f?ixlib=rb-1.2.1&auto=format&fit=crop&w=1200&q=80',
                location: opportunity.location || 'Global',
                type: opportunity.opportunity_type?.charAt(0).toUpperCase() + opportunity.opportunity_type?.slice(1) || 'Job',
                deadline: deadlineDisplay,
                badge: opportunity.subtype || opportunity.opportunity_type?.charAt(0).toUpperCase() + opportunity.opportunity_type?.slice(1) || 'Job',
                featured: opportunity.is_featured,
                organization: opportunity.organization || 'Organization',
                organization_logo: opportunity.organization_logo ? `http://127.0.0.1:8000${opportunity.organization_logo}` : 'https://via.placeholder.com/80',
                status: status,
                statusIcon: statusIcon,
                statusText: statusText,
                statusColor: statusColor,
                deadlineType: deadlineType,
                expired: isExpired
            };
        }
        
        function createOpportunityCard(opportunity) {
            const card = document.createElement('div');
            card.className = 'opportunity-card';
            card.style.cursor = 'pointer';
            card.innerHTML = `
                ${opportunity.featured ? '<div class="opportunity-featured"><i class="fas fa-star"></i></div>' : ''}
                <div class="opportunity-image" style="background-image: url('${opportunity.image}');">
                    <span class="opportunity-badge">${opportunity.badge}</span>
                </div>
                <div class="opportunity-content">
                    <h3 class="opportunity-title">
                        ${opportunity.title}
                        <div class="opportunity-status status-${opportunity.status}">
                            <div class="status-icon">
                                <i class="fas ${opportunity.statusIcon}" style="color: ${opportunity.statusColor};"></i>
                            </div>
                            <div class="status-text" style="color: ${opportunity.statusColor};">${opportunity.statusText}</div>
                        </div>
                    </h3>
                    <div class="opportunity-meta">
                        <span><i class="fas fa-globe"></i> ${opportunity.location}</span>
                        <span><i class="fas fa-briefcase"></i> ${opportunity.type}</span>
                    </div>
                    <div class="opportunity-deadline">
                        <span class="deadline-label">Deadline:</span>
                        <span class="deadline-date">${opportunity.deadline}</span>
                    </div>
                    <div class="opportunity-organization">
                        <div class="org-logo">
                            <img src="${opportunity.organization_logo}" alt="${opportunity.organization} Logo">
                        </div>
                        <div class="org-name">${opportunity.organization}</div>
                    </div>
                </div>
            `;
            
            card.addEventListener('click', () => {
                window.location.href = `opportunity-details.html?id=${opportunity.id}`;
            });
            
            return card;
        }
        
        function updateTrendingTicker() {
            const now = new Date();
            const latestJobs = allOpportunities
                .filter(opp => {
                    if (!opp.deadline) return true;
                    if (opp.deadline.toLowerCase().includes('rolling')) return true;
                    const deadline = new Date(opp.deadline);
                    return deadline >= now;
                })
                .sort((a, b) => new Date(b.created_at || b.id) - new Date(a.created_at || a.id))
                .slice(0, 10)
                .map(opp => opp.title)
                .join(' â¢ ');
            
            const trendingText = document.getElementById('trendingText');
            if (trendingText && latestJobs) {
                trendingText.textContent = latestJobs;
            }
        }
        
        function sortOpportunitiesByStatus(opportunities) {
            return opportunities.sort((a, b) => {
                const aFormatted = formatOpportunity(a);
                const bFormatted = formatOpportunity(b);
                
                // Priority order: active/ongoing/rolling > expired
                const statusPriority = {
                    'active': 1,
                    'ongoing': 2,
                    'rolling': 3,
                    'not_specified': 4,
                    'no_deadline': 5,
                    'expired': 6
                };
                
                const aPriority = statusPriority[aFormatted.status] || 5;
                const bPriority = statusPriority[bFormatted.status] || 5;
                
                if (aPriority !== bPriority) {
                    return aPriority - bPriority;
                }
                
                return new Date(b.created_at || b.id) - new Date(a.created_at || a.id);
            });
        }
        
        let currentPage = 1;
        const itemsPerPage = 30;
        let allJobsList = [];
        
        function populateJobs() {
            const featuredGrid = document.getElementById('featuredGrid');
            const jobsGrid = document.getElementById('jobsGrid');
            const viewMoreContainer = document.getElementById('viewMoreContainer');
            
            featuredGrid.innerHTML = '';
            jobsGrid.innerHTML = '';
            
            const featured = sortOpportunitiesByStatus(allOpportunities.filter(opp => opp.is_featured)).slice(0, 15).map(formatOpportunity);
            allJobsList = sortOpportunitiesByStatus([...allOpportunities]).map(formatOpportunity);
            
            featured.forEach(opp => featuredGrid.appendChild(createOpportunityCard(opp)));
            
            showJobsPage(1);
            
            if (allJobsList.length > itemsPerPage) {
                viewMoreContainer.style.display = 'block';
                updateViewMoreButton();
            } else {
                viewMoreContainer.style.display = 'none';
            }
        }
        
        function showJobsPage(page) {
            const jobsGrid = document.getElementById('jobsGrid');
            jobsGrid.innerHTML = '';
            
            const startIndex = 0;
            const endIndex = page * itemsPerPage;
            const itemsToShow = allJobsList.slice(startIndex, endIndex);
            
            itemsToShow.forEach(opp => jobsGrid.appendChild(createOpportunityCard(opp)));
        }
        
        function updateViewMoreButton() {
            const viewMoreBtn = document.getElementById('viewMoreBtn');
            const totalItems = allJobsList.length;
            const currentlyShowing = currentPage * itemsPerPage;
            
            if (currentlyShowing >= totalItems) {
                viewMoreBtn.innerHTML = '<i class="fas fa-chevron-up" style="margin-right: 8px;"></i>View Less';
            } else {
                const remaining = totalItems - currentlyShowing;
                viewMoreBtn.innerHTML = `<i class="fas fa-chevron-down" style="margin-right: 8px;"></i>View More (${remaining} more)`;
            }
        }
        
        let currentSlide = 0;
        let heroSlides = [];
        let slideInterval;
        
        async function initHeroCarousel() {
            const carouselInner = document.getElementById('heroCarousel');
            const indicatorsContainer = document.getElementById('heroIndicators');
            
            await fetchJobs();
            
            const now = new Date();
            const activeFeatured = allOpportunities.filter(opp => {
                if (!opp.is_featured) return false;
                if (!opp.deadline) return true;
                if (opp.deadline.toLowerCase().includes('rolling')) return true;
                const deadline = new Date(opp.deadline);
                return deadline >= now;
            });
            
            let carouselOpportunities = [...activeFeatured];
            if (carouselOpportunities.length < 10) {
                const latestOpportunities = allOpportunities
                    .filter(opp => {
                        if (activeFeatured.some(featured => featured.id === opp.id)) return false;
                        if (!opp.deadline) return true;
                        if (opp.deadline.toLowerCase().includes('rolling')) return true;
                        const deadline = new Date(opp.deadline);
                        return deadline >= now;
                    })
                    .sort((a, b) => new Date(b.created_at || b.id) - new Date(a.created_at || a.id))
                    .slice(0, 10 - carouselOpportunities.length);
                
                carouselOpportunities = [...carouselOpportunities, ...latestOpportunities];
            }
            
            const featuredOpportunities = carouselOpportunities.slice(0, 10).map(formatOpportunity);
            
            if (featuredOpportunities.length === 0) return;
            
            heroSlides = featuredOpportunities;
            
            featuredOpportunities.forEach((opportunity, index) => {
                const slide = document.createElement('div');
                slide.className = 'hero-slide';
                slide.style.backgroundImage = `url('${opportunity.image}')`;
                slide.style.cursor = 'pointer';
                
                slide.addEventListener('click', () => {
                    window.location.href = `opportunity-details.html?id=${opportunity.id}`;
                });
                
                slide.innerHTML = `
                    ${opportunity.featured ? '<div class="hero-slide-featured"><i class="fas fa-star"></i></div>' : ''}
                    <div class="hero-slide-badge">${opportunity.badge}</div>
                    <div class="hero-slide-content">
                        <h3 class="hero-slide-title">${opportunity.title}</h3>
                        <div class="hero-slide-meta">
                            <span><i class="fas fa-globe"></i> ${opportunity.location}</span>
                            <span><i class="fas fa-briefcase"></i> ${opportunity.type}</span>
                            <span><i class="fas fa-calendar-alt"></i> ${opportunity.deadline}</span>
                        </div>
                    </div>
                `;
                
                carouselInner.appendChild(slide);
            });
            
            featuredOpportunities.forEach((_, index) => {
                const indicator = document.createElement('div');
                indicator.className = 'hero-indicator';
                if (index === 0) indicator.classList.add('active');
                indicator.addEventListener('click', () => goToSlide(index));
                indicatorsContainer.appendChild(indicator);
            });
            
            const prevBtn = document.getElementById('heroPrevBtn');
            const nextBtn = document.getElementById('heroNextBtn');
            
            if (prevBtn) prevBtn.addEventListener('click', () => goToSlide(currentSlide - 1));
            if (nextBtn) nextBtn.addEventListener('click', () => goToSlide(currentSlide + 1));
            
            startAutoSlide();
        }
        
        function goToSlide(index) {
            if (heroSlides.length === 0) return;
            
            if (index < 0) index = heroSlides.length - 1;
            if (index >= heroSlides.length) index = 0;
            
            currentSlide = index;
            
            const carouselInner = document.getElementById('heroCarousel');
            const indicators = document.querySelectorAll('.hero-indicator');
            
            carouselInner.style.transform = `translateX(-${currentSlide * 100}%)`;
            
            indicators.forEach((indicator, i) => {
                indicator.classList.toggle('active', i === currentSlide);
            });
        }
        
        function startAutoSlide() {
            slideInterval = setInterval(() => {
                goToSlide(currentSlide + 1);
            }, 5000);
        }
        
        function updateDate() {
            const now = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            };
            
            const mobileOptions = {
                weekday: 'short',
                month: 'short',
                day: 'numeric'
            };
            
            const dateElement = document.getElementById('currentDate');
            const dateElementMobile = document.getElementById('currentDateMobile');
            
            const formattedDate = now.toLocaleDateString('en-US', options);
            const mobileDate = now.toLocaleDateString('en-US', mobileOptions);
            
            if (dateElement) {
                dateElement.textContent = formattedDate;
            }
            if (dateElementMobile) {
                dateElementMobile.textContent = mobileDate;
            }
        }
        
        // Show/hide deadline field based on deadline type
        document.getElementById('deadlineType').addEventListener('change', function() {
            const deadlineGroup = document.getElementById('deadlineGroup');
            const deadlineInput = document.getElementById('deadline');
            
            if (this.value === 'specific') {
                deadlineGroup.style.display = 'block';
                deadlineInput.required = true;
            } else {
                deadlineGroup.style.display = 'none';
                deadlineInput.required = false;
                deadlineInput.value = '';
            }
        });
        
        // Handle form submission
        document.getElementById('shareOpportunityForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            formData.append('status', 'pending');
            
            try {
                const response = await fetch('http://127.0.0.1:8000/api/opportunities/public-submit/', {
                    method: 'POST',
                    headers: {
                        'X-CSRFToken': getCookie('csrftoken')
                    },
                    body: formData
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    alert('Thank you! Your opportunity has been submitted for review. We will publish it after verification.');
                    this.reset();
                    document.getElementById('deadlineGroup').style.display = 'none';
                } else {
                    alert('Failed to submit opportunity: ' + (result.message || 'Please try again'));
                }
            } catch (error) {
                console.error('Error:', error);
                alert('Failed to submit opportunity. Please try again.');
            }
        });
        
        document.addEventListener('DOMContentLoaded', async function() {
            
            // Add click event to feedback button
            const feedbackBtns = document.querySelectorAll('.footer-btn');
            feedbackBtns.forEach(btn => {
                if (btn.textContent.includes('FEEDBACK')) {
                    btn.addEventListener('click', function(e) {
                        e.preventDefault();
                        showFeedbackModal();
                    });
                }
                if (btn.textContent.includes('SUBSCRIBE')) {
                    btn.addEventListener('click', function(e) {
                        e.preventDefault();
                        showNewsletterModal();
                    });
                }
            });
            
            // Community page initialization
            console.log('Starting community page initialization...');
            try {
                await fetchTopicStats();
                console.log('Community page initialization complete.');
                
                // Auto-refresh counts every 30 seconds
                setInterval(async () => {
                    try {
                        await fetchTopicStats();
                    } catch (error) {
                        console.error('Error auto-refreshing stats:', error);
                    }
                }, 30000);
                
            } catch (error) {
                console.error('Error during initialization:', error);
                console.log('Failed to load topic stats, using defaults');
            }
            updateDate();
            
            const viewMoreBtn = document.getElementById('viewMoreBtn');
            if (viewMoreBtn) {
                viewMoreBtn.addEventListener('click', function() {
                    const totalItems = allJobsList.length;
                    const currentlyShowing = currentPage * itemsPerPage;
                    
                    if (currentlyShowing >= totalItems) {
                        currentPage = 1;
                        showJobsPage(currentPage);
                    } else {
                        currentPage++;
                        showJobsPage(currentPage);
                    }
                    
                    updateViewMoreButton();
                });
            }
            
            const themeSelector = document.getElementById('themeSelector');
            const languageSelector = document.getElementById('languageSelector');
            
            const savedTheme = localStorage.getItem('theme') || 'light';
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-theme');
                if (themeSelector) themeSelector.value = 'dark';
            }
            
            const savedLang = localStorage.getItem('language') || 'en';
            if (languageSelector) languageSelector.value = savedLang;
            
            if (themeSelector) {
                themeSelector.addEventListener('change', function() {
                    if (this.value === 'dark') {
                        document.body.classList.add('dark-theme');
                        localStorage.setItem('theme', 'dark');
                    } else {
                        document.body.classList.remove('dark-theme');
                        localStorage.setItem('theme', 'light');
                    }
                });
            }
            
            if (languageSelector) {
                languageSelector.addEventListener('change', function() {
                    localStorage.setItem('language', this.value);
                });
            }
            
            const navToggleMobile = document.getElementById('navToggleMobile');
            const navMenu = document.getElementById('navMenu');
            const navOverlay = document.getElementById('navOverlay');
            
            function toggleNav() {
                navMenu.classList.toggle('active');
                navOverlay.classList.toggle('active');
            }
            
            function closeNav() {
                navMenu.classList.remove('active');
                navOverlay.classList.remove('active');
            }
            
            if (navToggleMobile) navToggleMobile.addEventListener('click', toggleNav);
            if (navOverlay) navOverlay.addEventListener('click', closeNav);
            
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => {
                link.addEventListener('click', closeNav);
            });
            
            const languageToggle = document.getElementById('languageToggle');
            const searchBtn = document.getElementById('searchBtn');
            const themeToggle = document.getElementById('themeToggle');
            
            if (languageToggle) {
                languageToggle.addEventListener('click', function(e) {
                    e.preventDefault();
                    showLanguageModal();
                });
            }
            
            if (searchBtn) {
                searchBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    showSearchModal();
                });
            }
            
            const desktopSearchBtn = document.getElementById('desktopSearchBtn');
            if (desktopSearchBtn) {
                desktopSearchBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    showSearchModal();
                });
            }
            
            const sidebarSearchBtn = document.getElementById('sidebarSearchBtn');
            const sidebarSearchInput = document.getElementById('sidebarSearchInput');
            
            if (sidebarSearchBtn) {
                sidebarSearchBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    showSearchModal();
                });
            }
            
            if (sidebarSearchInput) {
                sidebarSearchInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        showSearchModal();
                    }
                });
            }
            
            // Mobile theme toggle
            const themeIcon = document.getElementById('themeIcon');
            
            if (themeToggle) {
                themeToggle.addEventListener('click', function(e) {
                    e.preventDefault();
                    if (document.body.classList.contains('dark-theme')) {
                        document.body.classList.remove('dark-theme');
                        localStorage.setItem('theme', 'light');
                        themeIcon.className = 'fas fa-sun';
                        if (themeSelector) themeSelector.value = 'light';
                    } else {
                        document.body.classList.add('dark-theme');
                        localStorage.setItem('theme', 'dark');
                        themeIcon.className = 'far fa-sun';
                        if (themeSelector) themeSelector.value = 'dark';
                    }
                });
            }
            
            // Set initial theme icon
            if (themeIcon) {
                if (savedTheme === 'dark') {
                    themeIcon.className = 'far fa-sun';
                } else {
                    themeIcon.className = 'fas fa-sun';
                }
            }
            
            const header = document.querySelector('.header-container');
            if (header) {
                let headerHeight = header.offsetHeight;
                
                function updateLayout() {
                    const isMobile = window.innerWidth <= 768;
                    
                    if (isMobile) {
                        document.body.style.paddingTop = '100px';
                    } else {
                        document.body.style.paddingTop = headerHeight + 'px';
                    }
                }
                
                window.addEventListener('scroll', function() {
                    const isMobile = window.innerWidth <= 768;
                    
                    if (!isMobile) {
                        if (window.pageYOffset > 50) {
                            header.classList.add('scrolled');
                            document.body.style.paddingTop = (headerHeight - 30) + 'px';
                        } else {
                            header.classList.remove('scrolled');
                            document.body.style.paddingTop = headerHeight + 'px';
                        }
                    }
                });
                
                window.addEventListener('resize', function() {
                    headerHeight = header.offsetHeight;
                    updateLayout();
                });
                
                updateLayout();
            }
        });

        function showFeedbackModal() {
            const modal = document.createElement('div');
            modal.className = 'search-modal';
            modal.innerHTML = `
                <div class="modal-content feedback-modal">
                    <div class="modal-header">
                        <h3>Send Feedback</h3>
                        <button class="modal-close">&times;</button>
                    </div>
                    <div class="modal-body-scroll">
                        <form id="feedbackForm">
                            <div class="form-group">
                                <label for="feedbackName">Name *</label>
                                <input type="text" id="feedbackName" name="name" required>
                            </div>
                            <div class="form-group">
                                <label for="feedbackEmail">Email *</label>
                                <input type="email" id="feedbackEmail" name="email" required>
                            </div>
                            <div class="form-group">
                                <label for="feedbackSubject">Subject *</label>
                                <input type="text" id="feedbackSubject" name="subject" required>
                            </div>
                            <div class="form-group">
                                <label for="feedbackMessage">Message *</label>
                                <textarea id="feedbackMessage" name="message" rows="4" required></textarea>
                            </div>
                            <div class="form-actions">
                                <button type="button" onclick="closeFeedbackModal()">Cancel</button>
                                <button type="submit">Send</button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            
            setTimeout(() => modal.classList.add('show'), 10);
            
            function closeModal() {
                modal.classList.remove('show');
                setTimeout(() => {
                    if (document.body.contains(modal)) {
                        document.body.removeChild(modal);
                    }
                }, 300);
            }
            
            window.closeFeedbackModal = closeModal;
            
            modal.querySelector('.modal-close').onclick = closeModal;
            modal.onclick = (e) => { if (e.target === modal) closeModal(); };
            
            const form = modal.querySelector('#feedbackForm');
            form.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const formData = new FormData(this);
                const data = Object.fromEntries(formData.entries());
                data.feedback_type = 'general';
                
                try {
                    const response = await fetch('http://127.0.0.1:8000/api/feedback/', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': getCookie('csrftoken')
                        },
                        body: JSON.stringify(data)
                    });
                    
                    const result = await response.json();
                    
                    if (response.ok) {
                        alert(result.message);
                        closeModal();
                    } else {
                        alert(result.message || 'Failed to send feedback');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    alert('Failed to send feedback. Please try again.');
                }
            });
        }
        
        function showNewsletterModal() {
            const modal = document.createElement('div');
            modal.className = 'search-modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Subscribe to Newsletter</h3>
                        <button class="modal-close">&times;</button>
                    </div>
                    <div class="modal-body">
                        <form id="newsletterForm">
                            <div class="form-group">
                                <label for="newsletterName">Name (Optional)</label>
                                <input type="text" id="newsletterName" name="name">
                            </div>
                            <div class="form-group">
                                <label for="newsletterEmail">Email *</label>
                                <input type="email" id="newsletterEmail" name="email" required>
                            </div>
                            <div class="form-actions">
                                <button type="button" onclick="closeNewsletterModal()">Cancel</button>
                                <button type="submit">Subscribe</button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            
            setTimeout(() => modal.classList.add('show'), 10);
            
            function closeModal() {
                modal.classList.remove('show');
                setTimeout(() => {
                    if (document.body.contains(modal)) {
                        document.body.removeChild(modal);
                    }
                }, 300);
            }
            
            window.closeNewsletterModal = closeModal;
            
            modal.querySelector('.modal-close').onclick = closeModal;
            modal.onclick = (e) => { if (e.target === modal) closeModal(); };
            
            const form = modal.querySelector('#newsletterForm');
            form.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const formData = new FormData(this);
                const data = Object.fromEntries(formData.entries());
                
                try {
                    const response = await fetch('http://127.0.0.1:8000/api/newsletter/subscribe/', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': getCookie('csrftoken')
                        },
                        body: JSON.stringify(data)
                    });
                    
                    const result = await response.json();
                    
                    if (response.ok) {
                        alert(result.message);
                        closeModal();
                    } else {
                        alert(result.message || 'Failed to subscribe');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    alert('Failed to subscribe. Please try again.');
                }
            });
        }
        
        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue || document.querySelector('meta[name="csrf-token"]')?.getAttribute('content');
        }
        
        function showLanguageModal() {
            const modal = document.createElement('div');
            modal.className = 'language-modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Select Language</h3>
                        <button class="modal-close">&times;</button>
                    </div>
                    <div class="language-options">
                        <div class="lang-option" data-lang="en"><span class="fi fi-us"></span> English</div>
                        <div class="lang-option" data-lang="zh"><span class="fi fi-cn"></span> ä¸­æ (Chinese)</div>
                        <div class="lang-option" data-lang="es"><span class="fi fi-es"></span> EspaÃ±ol (Spanish)</div>
                        <div class="lang-option" data-lang="fr"><span class="fi fi-fr"></span> FranÃ§ais (French)</div>
                        <div class="lang-option" data-lang="ar"><span class="fi fi-sa"></span> Ø§ÙØ¹Ø±Ø¨ÙØ© (Arabic)</div>
                        <div class="lang-option" data-lang="hi"><span class="fi fi-in"></span> à¤¹à¤¿à¤¨à¥à¤¦à¥ (Hindi)</div>
                        <div class="lang-option" data-lang="pt"><span class="fi fi-pt"></span> PortuguÃªs (Portuguese)</div>
                        <div class="lang-option" data-lang="ru"><span class="fi fi-ru"></span> Ð ÑÑÑÐºÐ¸Ð¹ (Russian)</div>
                        <div class="lang-option" data-lang="de"><span class="fi fi-de"></span> Deutsch (German)</div>
                        <div class="lang-option" data-lang="ja"><span class="fi fi-jp"></span> æ¥æ¬èª (Japanese)</div>
                        <div class="lang-option" data-lang="sw"><span class="fi fi-ke"></span> Kiswahili (Swahili)</div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            
            setTimeout(() => modal.classList.add('show'), 10);
            
            function closeModal() {
                modal.classList.remove('show');
                setTimeout(() => {
                    if (document.body.contains(modal)) {
                        document.body.removeChild(modal);
                    }
                }, 300);
            }
            
            modal.querySelector('.modal-close').onclick = closeModal;
            modal.onclick = (e) => { if (e.target === modal) closeModal(); };
            
            modal.querySelectorAll('.lang-option').forEach(option => {
                option.onclick = () => {
                    const lang = option.dataset.lang;
                    const languageSelector = document.getElementById('languageSelector');
                    if (languageSelector) languageSelector.value = lang;
                    localStorage.setItem('language', lang);
                    closeModal();
                };
            });
        }
        
        async function toggleTopicDiscussions(topicId) {
            const section = document.getElementById(`${topicId}-discussions-section`);
            const allSections = document.querySelectorAll('.topic-discussions');
            
            // Hide all other sections
            allSections.forEach(s => {
                if (s.id !== `${topicId}-discussions-section`) {
                    s.style.display = 'none';
                }
            });
            
            // Toggle current section
            if (section.style.display === 'none' || !section.style.display) {
                section.style.display = 'block';
                await loadTopicDiscussions(topicId);
                // Scroll to discussions section
                setTimeout(() => {
                    section.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 100);
            } else {
                section.style.display = 'none';
            }
        }
        
        async function loadTopicDiscussions(topicId) {
            const section = document.getElementById(`${topicId}-discussions-section`);
            const topic = communityTopics[topicId];
            
            section.innerHTML = '<p>Loading discussions...</p>';
            
            try {
                const response = await fetch(`http://127.0.0.1:8000/api/community/discussions/?topic=${topicId}`);
                const discussions = await response.json();
                
                let content = `<h3 style="color: var(--primary); margin-bottom: 20px;">${topic.title} Discussions</h3>`;
                
                if (discussions.length === 0) {
                    content += '<p style="text-align: center; color: var(--gray); padding: 20px;">No discussions yet. Be the first to ask a question!</p>';
                } else {
                    for (let i = 0; i < discussions.length; i++) {
                        const discussion = discussions[i];
                        const repliesResponse = await fetch(`http://127.0.0.1:8000/api/community/discussions/${discussion.id}/replies/`);
                        const replies = await repliesResponse.json();
                        
                        const visibleReplies = replies.slice(0, 1);
                        const hiddenReplies = replies.slice(1);
                        
                        content += `
                            <div class="discussion-post" style="border: 2px solid var(--light-gray); border-radius: 12px; margin-bottom: 40px; background: var(--card-bg); box-shadow: 0 4px 12px rgba(0,0,0,0.1); position: relative;">
                                <!-- Question Number Badge -->
                                <div style="position: absolute; top: -10px; left: 20px; background: var(--primary); color: white; padding: 5px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 600;">Question #${i + 1}</div>
                                
                                <!-- Post Header -->
                                <div style="padding: 25px 20px 20px; border-bottom: 2px solid var(--light-gray);">
                                    <div style="margin-bottom: 15px;">
                                        <h4 style="color: var(--primary); margin: 0; font-size: 1.2rem; font-weight: 700;">${discussion.title}</h4>
                                    </div>
                                    <div style="color: var(--text-color); line-height: 1.7; margin-bottom: 20px; font-size: 1rem;">${discussion.content}</div>
                                    <div style="display: flex; justify-content: space-between; align-items: center; font-size: 0.9rem; color: var(--gray);">
                                        <span><i class="fas fa-calendar" style="margin-right: 8px;"></i> ${new Date(discussion.created_at).toLocaleDateString()}</span>
                                        <span><i class="fas fa-comment" style="margin-right: 8px;"></i> ${replies.length} replies</span>
                                    </div>
                                </div>
                                
                                <!-- Replies Section -->
                                <div style="padding: 0 20px;">
                                    <div id="replies-visible-${discussion.id}">
                                        ${visibleReplies.map((reply, index) => `
                                            <div class="reply-item" style="margin: 15px 0; position: relative;">
                                                <!-- Comment Badge -->
                                                <div style="position: absolute; top: -8px; left: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 4px 12px; border-radius: 12px; font-size: 0.75rem; font-weight: 600; z-index: 1;">ð¬ Comment #${index + 1}</div>
                                                
                                                <!-- Comment Card -->
                                                <div style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%); border: 2px solid rgba(102, 126, 234, 0.2); border-radius: 16px; padding: 20px; margin-left: 20px; position: relative; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.1);">
                                                    <!-- Comment Icon -->
                                                    <div style="position: absolute; top: -10px; left: -10px; width: 30px; height: 30px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);">
                                                        <i class="fas fa-comment" style="color: white; font-size: 0.8rem;"></i>
                                                    </div>
                                                    
                                                    <!-- Comment Content -->
                                                    <div style="margin-left: 15px;">
                                                        <div style="color: var(--text-color); line-height: 1.7; margin-bottom: 12px; font-size: 0.95rem; font-weight: 500;">${reply.content}</div>
                                                        <div style="display: flex; align-items: center; gap: 15px; font-size: 0.8rem; color: var(--gray);">
                                                            <span style="display: flex; align-items: center; gap: 5px;"><i class="fas fa-clock" style="color: #667eea;"></i> ${new Date(reply.created_at).toLocaleDateString()}</span>
                                                            <span style="display: flex; align-items: center; gap: 5px;"><i class="fas fa-user" style="color: #667eea;"></i> Anonymous</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        `).join('')}
                                    </div>
                                    
                                    ${hiddenReplies.length > 0 ? `
                                        <div id="replies-hidden-${discussion.id}" style="display: none;">
                                            ${hiddenReplies.map((reply, index) => `
                                                <div class="reply-item" style="margin: 15px 0; position: relative;">
                                                    <!-- Comment Badge -->
                                                    <div style="position: absolute; top: -8px; left: 15px; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; padding: 4px 12px; border-radius: 12px; font-size: 0.75rem; font-weight: 600; z-index: 1;">ð¬ Comment #${visibleReplies.length + index + 1}</div>
                                                    
                                                    <!-- Comment Card -->
                                                    <div style="background: linear-gradient(135deg, rgba(79, 172, 254, 0.05) 0%, rgba(0, 242, 254, 0.05) 100%); border: 2px solid rgba(79, 172, 254, 0.2); border-radius: 16px; padding: 20px; margin-left: 20px; position: relative; box-shadow: 0 4px 15px rgba(79, 172, 254, 0.1);">
                                                        <!-- Comment Icon -->
                                                        <div style="position: absolute; top: -10px; left: -10px; width: 30px; height: 30px; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 8px rgba(79, 172, 254, 0.3);">
                                                            <i class="fas fa-comment" style="color: white; font-size: 0.8rem;"></i>
                                                        </div>
                                                        
                                                        <!-- Comment Content -->
                                                        <div style="margin-left: 15px;">
                                                            <div style="color: var(--text-color); line-height: 1.7; margin-bottom: 12px; font-size: 0.95rem; font-weight: 500;">${reply.content}</div>
                                                            <div style="display: flex; align-items: center; gap: 15px; font-size: 0.8rem; color: var(--gray);">
                                                                <span style="display: flex; align-items: center; gap: 5px;"><i class="fas fa-clock" style="color: #4facfe;"></i> ${new Date(reply.created_at).toLocaleDateString()}</span>
                                                                <span style="display: flex; align-items: center; gap: 5px;"><i class="fas fa-user" style="color: #4facfe;"></i> Anonymous</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            `).join('')}
                                        </div>
                                        <div style="text-align: center; padding: 15px 0;">
                                            <button id="toggle-replies-${discussion.id}" onclick="toggleReplies(${discussion.id})" style="background: none; border: 1px solid var(--primary); color: var(--primary); padding: 8px 16px; border-radius: 20px; cursor: pointer; font-size: 0.9rem; transition: all 0.3s ease;" onmouseover="this.style.background='var(--primary)'; this.style.color='white'" onmouseout="this.style.background='none'; this.style.color='var(--primary)'">
                                                <i class="fas fa-chevron-down" style="margin-right: 5px;"></i> Show ${hiddenReplies.length} more replies
                                            </button>
                                        </div>
                                    ` : ''}
                                </div>
                                
                                <!-- Reply Form -->
                                <div style="padding: 25px 20px; background: var(--light); border-radius: 0 0 12px 12px; border-top: 1px solid var(--light-gray);">
                                    <form onsubmit="submitReply(event, ${discussion.id})" style="display: flex; gap: 15px; align-items: end;">
                                        <div style="flex: 1;">
                                            <textarea name="content" placeholder="Write a reply..." required style="width: 100%; padding: 15px; border: 2px solid var(--light-gray); border-radius: 10px; resize: vertical; min-height: 70px; font-family: inherit; transition: border-color 0.3s ease;" onfocus="this.style.borderColor='var(--primary)'" onblur="this.style.borderColor='var(--light-gray)'"></textarea>
                                        </div>
                                        <button type="submit" style="background: var(--primary); color: white; border: none; padding: 15px 25px; border-radius: 10px; font-weight: 600; cursor: pointer; white-space: nowrap; transition: all 0.3s ease;" onmouseover="this.style.background='var(--primary-dark)'" onmouseout="this.style.background='var(--primary)'">Reply</button>
                                    </form>
                                </div>
                            </div>
                        `;
                    }
                }
                
                content += `
                    <div style="margin: 40px 0 60px; padding: 30px 20px; border-top: 2px solid var(--light-gray); text-align: center; background: var(--light); border-radius: 12px;">
                        <button onclick="showTopicQuestionModal('${topicId}')" style="background: var(--primary); color: white; border: none; padding: 15px 30px; border-radius: 10px; font-weight: 600; cursor: pointer; font-size: 1.1rem; transition: all 0.3s ease; box-shadow: 0 4px 12px rgba(22, 178, 220, 0.3);" onmouseover="this.style.background='var(--primary-dark)'; this.style.transform='translateY(-2px)'" onmouseout="this.style.background='var(--primary)'; this.style.transform='translateY(0)'">Ask Question in ${topic.title}</button>
                    </div>
                `;
                
                section.innerHTML = content;
                
            } catch (error) {
                console.error('Error loading discussions:', error);
                section.innerHTML = '<p style="color: red;">Error loading discussions</p>';
            }
        }
        
        async function showTopicDetails(topicId) {
            const topic = communityTopics[topicId];
            if (!topic) return;
            
            const modal = document.createElement('div');
            modal.className = 'search-modal';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 800px;">
                    <div class="modal-header">
                        <h3>${topic.title} - Discussions</h3>
                        <button class="modal-close">&times;</button>
                    </div>
                    <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                        <div id="topicDiscussions">Loading discussions...</div>
                        <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--light-gray);">
                            <button onclick="showQuestionModal('${topicId}')" style="background: var(--primary); color: white; border: none; padding: 12px 20px; border-radius: 6px; font-weight: 600; cursor: pointer; width: 100%;">Ask New Question in ${topic.title}</button>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            
            setTimeout(() => modal.classList.add('show'), 10);
            
            // Load discussions for this topic
            try {
                const response = await fetch(`http://127.0.0.1:8000/api/community/discussions/?topic=${topicId}`);
                const discussions = await response.json();
                
                const discussionsContainer = modal.querySelector('#topicDiscussions');
                if (discussions.length === 0) {
                    discussionsContainer.innerHTML = '<p style="text-align: center; color: var(--gray); padding: 20px;">No discussions yet. Be the first to ask a question!</p>';
                } else {
                    discussionsContainer.innerHTML = discussions.map(discussion => `
                        <div style="border: 1px solid var(--light-gray); border-radius: 8px; padding: 15px; margin-bottom: 15px;">
                            <div style="font-weight: 600; margin-bottom: 10px; color: var(--primary); cursor: pointer;" onclick="showDiscussionDetails(${discussion.id})">
                                Q: ${discussion.title}
                            </div>
                            <div style="color: var(--gray); margin-bottom: 10px; font-size: 0.9rem;">
                                ${discussion.content.substring(0, 150)}${discussion.content.length > 150 ? '...' : ''}
                            </div>
                            <div style="display: flex; gap: 15px; font-size: 0.9rem; color: var(--gray);">
                                <span style="cursor: pointer;" onclick="showDiscussionDetails(${discussion.id})"><i class="fas fa-comment"></i> ${discussion.replies_count} replies</span>
                                <span style="color: var(--light-gray);">â¢</span>
                                <span>${new Date(discussion.created_at).toLocaleDateString()}</span>
                            </div>
                        </div>
                    `).join('');
                }
            } catch (error) {
                console.error('Error loading discussions:', error);
                modal.querySelector('#topicDiscussions').innerHTML = '<p style="color: red;">Error loading discussions</p>';
            }
            
            function closeModal() {
                modal.classList.remove('show');
                setTimeout(() => {
                    if (document.body.contains(modal)) {
                        document.body.removeChild(modal);
                    }
                }, 300);
            }
            
            modal.querySelector('.modal-close').onclick = closeModal;
            modal.onclick = (e) => { if (e.target === modal) closeModal(); };
        }
        
        async function showDiscussionDetails(discussionId) {
            // Only use modal for individual discussion details
            const modal = document.createElement('div');
            modal.className = 'search-modal';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 900px;">
                    <div class="modal-header">
                        <h3>Discussion Details</h3>
                        <button class="modal-close">&times;</button>
                    </div>
                    <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                        <div id="discussionContent">Loading...</div>
                        <div id="repliesSection" style="margin-top: 20px;"></div>
                        <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--light-gray);">
                            <h4>Add Reply</h4>
                            <form id="replyForm">
                                <textarea name="content" rows="3" placeholder="Write your reply..." required style="width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: 6px; margin: 10px 0;"></textarea>
                                <button type="submit" style="background: var(--primary); color: white; border: none; padding: 10px 20px; border-radius: 6px; font-weight: 600; cursor: pointer;">Post Reply</button>
                            </form>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            setTimeout(() => modal.classList.add('show'), 10);
            
            // Load discussion and replies
            try {
                const repliesResponse = await fetch(`http://127.0.0.1:8000/api/community/discussions/${discussionId}/replies/`);
                const replies = await repliesResponse.json();
                
                modal.querySelector('#discussionContent').innerHTML = `
                    <div style="border: 1px solid var(--primary); border-radius: 8px; padding: 20px; background: rgba(22, 178, 220, 0.05);">
                        <h4 style="color: var(--primary); margin-bottom: 10px;">Discussion #${discussionId}</h4>
                        <p style="margin-bottom: 10px;">Loading discussion details...</p>
                    </div>
                `;
                
                const repliesContainer = modal.querySelector('#repliesSection');
                if (replies.length > 0) {
                    repliesContainer.innerHTML = `
                        <h4>Replies (${replies.length})</h4>
                        ${replies.map(reply => `
                            <div style="border-left: 3px solid var(--primary); padding-left: 15px; margin: 15px 0;">
                                <p>${reply.content}</p>
                                <small style="color: var(--gray);">Posted on ${new Date(reply.created_at).toLocaleDateString()}</small>
                            </div>
                        `).join('')}
                    `;
                } else {
                    repliesContainer.innerHTML = '<h4>No replies yet. Be the first to reply!</h4>';
                }
            } catch (error) {
                console.error('Error loading discussion:', error);
                modal.querySelector('#discussionContent').innerHTML = '<p style="color: red;">Error loading discussion</p>';
            }
            
            // Handle reply submission
            modal.querySelector('#replyForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                const formData = new FormData(this);
                const content = formData.get('content');
                
                try {
                    const response = await fetch(`http://127.0.0.1:8000/api/community/discussions/${discussionId}/replies/`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': getCookie('csrftoken')
                        },
                        body: JSON.stringify({ content })
                    });
                    
                    if (response.ok) {
                        alert('Reply posted successfully!');
                        showDiscussionDetails(discussionId);
                    } else {
                        alert('Failed to post reply');
                    }
                } catch (error) {
                    console.error('Error posting reply:', error);
                    alert('Failed to post reply');
                }
            });
            
            function closeModal() {
                modal.classList.remove('show');
                setTimeout(() => {
                    if (document.body.contains(modal)) {
                        document.body.removeChild(modal);
                    }
                }, 300);
            }
            
            modal.querySelector('.modal-close').onclick = closeModal;
            modal.onclick = (e) => { if (e.target === modal) closeModal(); };
        }
        
        async function showDiscussionDetailsOld(discussionId) {
            const modal = document.createElement('div');
            modal.className = 'search-modal';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 900px;">
                    <div class="modal-header">
                        <h3>Discussion Details</h3>
                        <button class="modal-close">&times;</button>
                    </div>
                    <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                        <div id="discussionContent">Loading...</div>
                        <div id="repliesSection" style="margin-top: 20px;"></div>
                        <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--light-gray);">
                            <h4>Add Reply</h4>
                            <form id="replyForm">
                                <textarea name="content" rows="3" placeholder="Write your reply..." required style="width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: 6px; margin: 10px 0;"></textarea>
                                <button type="submit" style="background: var(--primary); color: white; border: none; padding: 10px 20px; border-radius: 6px; font-weight: 600; cursor: pointer;">Post Reply</button>
                            </form>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            setTimeout(() => modal.classList.add('show'), 10);
            
            // Load discussion and replies
            try {
                const repliesResponse = await fetch(`http://127.0.0.1:8000/api/community/discussions/${discussionId}/replies/`);
                const replies = await repliesResponse.json();
                
                modal.querySelector('#discussionContent').innerHTML = `
                    <div style="border: 1px solid var(--primary); border-radius: 8px; padding: 20px; background: rgba(22, 178, 220, 0.05);">
                        <h4 style="color: var(--primary); margin-bottom: 10px;">Discussion #${discussionId}</h4>
                        <p style="margin-bottom: 10px;">Loading discussion details...</p>
                    </div>
                `;
                
                const repliesContainer = modal.querySelector('#repliesSection');
                if (replies.length > 0) {
                    repliesContainer.innerHTML = `
                        <h4>Replies (${replies.length})</h4>
                        ${replies.map(reply => `
                            <div style="border-left: 3px solid var(--primary); padding-left: 15px; margin: 15px 0;">
                                <p>${reply.content}</p>
                                <small style="color: var(--gray);">Posted on ${new Date(reply.created_at).toLocaleDateString()}</small>
                            </div>
                        `).join('')}
                    `;
                } else {
                    repliesContainer.innerHTML = '<h4>No replies yet. Be the first to reply!</h4>';
                }
            } catch (error) {
                console.error('Error loading discussion:', error);
                modal.querySelector('#discussionContent').innerHTML = '<p style="color: red;">Error loading discussion</p>';
            }
            
            // Handle reply submission
            modal.querySelector('#replyForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                const formData = new FormData(this);
                const content = formData.get('content');
                
                try {
                    const response = await fetch(`http://127.0.0.1:8000/api/community/discussions/${discussionId}/replies/`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': getCookie('csrftoken')
                        },
                        body: JSON.stringify({ content })
                    });
                    
                    if (response.ok) {
                        alert('Reply posted successfully!');
                        showDiscussionDetails(discussionId);
                    } else {
                        alert('Failed to post reply');
                    }
                } catch (error) {
                    console.error('Error posting reply:', error);
                    alert('Failed to post reply');
                }
            });
            
            function closeModal() {
                modal.classList.remove('show');
                setTimeout(() => {
                    if (document.body.contains(modal)) {
                        document.body.removeChild(modal);
                    }
                }, 300);
            }
            
            modal.querySelector('.modal-close').onclick = closeModal;
            modal.onclick = (e) => { if (e.target === modal) closeModal(); };
        }
        
        // General question modal (with topic selection)
        function showQuestionModal(topicId = null) {
            const topics = Object.keys(communityTopics);
            const modal = document.createElement('div');
            modal.className = 'search-modal';
            modal.innerHTML = `
                <div class="modal-content feedback-modal">
                    <div class="modal-header">
                        <h3>Ask New Question</h3>
                        <button class="modal-close">&times;</button>
                    </div>
                    <div class="modal-body-scroll">
                        <form id="questionForm">
                            <div class="form-group">
                                <label for="questionTopic">Topic *</label>
                                <select id="questionTopic" name="topic" required>
                                    <option value="">Select a topic...</option>
                                    ${topics.map(id => `<option value="${id}" ${topicId === id ? 'selected' : ''}>${communityTopics[id].title}</option>`).join('')}
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="questionTitle">Question Title *</label>
                                <input type="text" id="questionTitle" name="title" required placeholder="Brief summary of your question...">
                            </div>
                            <div class="form-group">
                                <label for="questionContent">Question Details *</label>
                                <textarea id="questionContent" name="content" rows="4" required placeholder="Describe your question in detail..."></textarea>
                            </div>
                            <div class="form-actions">
                                <button type="button" onclick="closeQuestionModal()">Cancel</button>
                                <button type="submit">Post Question</button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            setTimeout(() => modal.classList.add('show'), 10);
            
            function closeModal() {
                modal.classList.remove('show');
                setTimeout(() => {
                    if (document.body.contains(modal)) {
                        document.body.removeChild(modal);
                    }
                }, 300);
            }
            
            window.closeQuestionModal = closeModal;
            modal.querySelector('.modal-close').onclick = closeModal;
            modal.onclick = (e) => { if (e.target === modal) closeModal(); };
            
            modal.querySelector('#questionForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const confirmed = confirm('â ï¸ IMPORTANT NOTICE\n\nPlease review your question carefully before posting:\n\nâ¢ You CANNOT edit or delete your question once posted\nâ¢ Make sure there are no spelling or grammar errors\nâ¢ Ensure your question is clear and complete\n\nDo you want to proceed with posting this question?');
                
                if (!confirmed) return;
                
                const formData = new FormData(this);
                const data = {
                    topic: formData.get('topic'),
                    title: formData.get('title'),
                    content: formData.get('content')
                };
                
                try {
                    const response = await fetch('http://127.0.0.1:8000/api/community/discussions/', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': getCookie('csrftoken')
                        },
                        body: JSON.stringify(data)
                    });
                    
                    const result = await response.json();
                    
                    if (response.ok) {
                        showSuccessMessage('Question posted successfully!');
                        closeModal();
                        await fetchTopicStats();
                        await toggleTopicDiscussions(data.topic);
                    } else {
                        alert('Failed to submit question: ' + (result.error || 'Unknown error'));
                    }
                } catch (error) {
                    console.error('Error submitting question:', error);
                    alert('Failed to submit question. Please try again.');
                }
            });
        }
        
        // Topic-specific question modal (no topic selection)
        function showTopicQuestionModal(topicId) {
            const topic = communityTopics[topicId];
            const modal = document.createElement('div');
            modal.className = 'search-modal';
            modal.innerHTML = `
                <div class="modal-content feedback-modal">
                    <div class="modal-header">
                        <h3>Ask Question in ${topic.title}</h3>
                        <button class="modal-close">&times;</button>
                    </div>
                    <div class="modal-body-scroll">
                        <form id="topicQuestionForm">
                            <div class="form-group">
                                <label for="topicQuestionTitle">Question Title *</label>
                                <input type="text" id="topicQuestionTitle" name="title" required placeholder="Brief summary of your question...">
                            </div>
                            <div class="form-group">
                                <label for="topicQuestionContent">Question Details *</label>
                                <textarea id="topicQuestionContent" name="content" rows="4" required placeholder="Describe your question in detail..."></textarea>
                            </div>
                            <div class="form-actions">
                                <button type="button" onclick="closeTopicQuestionModal()">Cancel</button>
                                <button type="submit">Post Question</button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            setTimeout(() => modal.classList.add('show'), 10);
            
            function closeModal() {
                modal.classList.remove('show');
                setTimeout(() => {
                    if (document.body.contains(modal)) {
                        document.body.removeChild(modal);
                    }
                }, 300);
            }
            
            window.closeTopicQuestionModal = closeModal;
            modal.querySelector('.modal-close').onclick = closeModal;
            modal.onclick = (e) => { if (e.target === modal) closeModal(); };
            
            modal.querySelector('#topicQuestionForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const confirmed = confirm('â ï¸ IMPORTANT NOTICE\n\nPlease review your question carefully before posting:\n\nâ¢ You CANNOT edit or delete your question once posted\nâ¢ Make sure there are no spelling or grammar errors\nâ¢ Ensure your question is clear and complete\n\nDo you want to proceed with posting this question?');
                
                if (!confirmed) return;
                
                const formData = new FormData(this);
                const data = {
                    topic: topicId,
                    title: formData.get('title'),
                    content: formData.get('content')
                };
                
                try {
                    const response = await fetch('http://127.0.0.1:8000/api/community/discussions/', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': getCookie('csrftoken')
                        },
                        body: JSON.stringify(data)
                    });
                    
                    const result = await response.json();
                    
                    if (response.ok) {
                        showSuccessMessage('Question posted successfully!');
                        closeModal();
                        await fetchTopicStats();
                        await loadTopicDiscussions(topicId);
                    } else {
                        alert('Failed to submit question: ' + (result.error || 'Unknown error'));
                    }
                } catch (error) {
                    console.error('Error submitting question:', error);
                    alert('Failed to submit question. Please try again.');
                }
            });
        }
        
        function showSearchModal() {
            const modal = document.createElement('div');
            modal.className = 'search-modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Search Community Discussions</h3>
                        <button class="modal-close">&times;</button>
                    </div>
                    <div class="search-form">
                        <input type="text" class="modal-search-input" placeholder="Search community discussions..." autofocus>
                        <button class="modal-search-btn"><i class="fas fa-search"></i> Search</button>
                    </div>
                    <div class="search-results" id="searchResults"></div>
                </div>
            `;
            document.body.appendChild(modal);
            
            setTimeout(() => modal.classList.add('show'), 10);
            
            const searchInput = modal.querySelector('.modal-search-input');
            const searchButton = modal.querySelector('.modal-search-btn');
            const resultsDiv = modal.querySelector('#searchResults');
            
            function closeModal() {
                modal.classList.remove('show');
                setTimeout(() => {
                    if (document.body.contains(modal)) {
                        document.body.removeChild(modal);
                    }
                }, 300);
            }
            
            async function performModalSearch() {
                const query = searchInput.value.toLowerCase().trim();
                if (!query) return;
                
                resultsDiv.innerHTML = '<p>Searching discussions...</p>';
                
                try {
                    // Search through all topics for discussions
                    const allDiscussions = [];
                    
                    for (const topicId of Object.keys(communityTopics)) {
                        try {
                            const response = await fetch(`http://127.0.0.1:8000/api/community/discussions/?topic=${topicId}`);
                            if (response.ok) {
                                const discussions = await response.json();
                                discussions.forEach(discussion => {
                                    if (discussion.title.toLowerCase().includes(query) || 
                                        discussion.content.toLowerCase().includes(query)) {
                                        allDiscussions.push({
                                            ...discussion,
                                            topic: communityTopics[topicId].title,
                                            topicId: topicId
                                        });
                                    }
                                });
                            }
                        } catch (err) {
                            console.error(`Error searching ${topicId}:`, err);
                        }
                    }
                    
                    resultsDiv.innerHTML = `<h4>${allDiscussions.length} discussion results found</h4>`;
                    
                    if (allDiscussions.length === 0) {
                        resultsDiv.innerHTML += '<p style="text-align: center; color: var(--gray); padding: 20px;">No discussions found matching your search.</p>';
                    } else {
                        allDiscussions.slice(0, 10).forEach(discussion => {
                            const resultItem = document.createElement('div');
                            resultItem.className = 'search-result-item';
                            resultItem.innerHTML = `
                                <h5>${discussion.title}</h5>
                                <p><strong>${discussion.topic}</strong> â¢ ${discussion.content.substring(0, 100)}${discussion.content.length > 100 ? '...' : ''}</p>
                                <small style="color: var(--gray);">Posted on ${new Date(discussion.created_at).toLocaleDateString()}</small>
                            `;
                            resultItem.onclick = () => {
                                closeModal();
                                toggleTopicDiscussions(discussion.topicId);
                            };
                            resultsDiv.appendChild(resultItem);
                        });
                    }
                } catch (error) {
                    console.error('Search error:', error);
                    resultsDiv.innerHTML = '<p style="color: red;">Error searching discussions. Please try again.</p>';
                }
            }
            
            searchButton.onclick = performModalSearch;
            searchInput.onkeypress = (e) => { if (e.key === 'Enter') performModalSearch(); };
            
            modal.querySelector('.modal-close').onclick = closeModal;
            modal.onclick = (e) => { if (e.target === modal) closeModal(); };
            
            setTimeout(() => searchInput.focus(), 100);
        }
        
        // Success message function
        function showSuccessMessage(message) {
            const successDiv = document.createElement('div');
            successDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #27ae60;
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                font-weight: 600;
                z-index: 10000;
                box-shadow: 0 4px 12px rgba(0,0,0,0.2);
                animation: slideIn 0.3s ease;
            `;
            successDiv.textContent = message;
            
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
            `;
            document.head.appendChild(style);
            document.body.appendChild(successDiv);
            
            setTimeout(() => {
                successDiv.remove();
                style.remove();
            }, 3000);
        }
        
        // Reply submission
        async function submitReply(event, discussionId) {
            event.preventDefault();
            const form = event.target;
            const formData = new FormData(form);
            const content = formData.get('content');
            
            try {
                const response = await fetch(`http://127.0.0.1:8000/api/community/discussions/${discussionId}/replies/`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': getCookie('csrftoken')
                    },
                    body: JSON.stringify({ content })
                });
                
                if (response.ok) {
                    showSuccessMessage('Reply posted successfully!');
                    form.reset();
                    // Find which topic this discussion belongs to and reload
                    const topicId = getCurrentTopicId();
                    if (topicId) {
                        await loadTopicDiscussions(topicId);
                    }
                } else {
                    alert('Failed to post reply');
                }
            } catch (error) {
                console.error('Error posting reply:', error);
                alert('Failed to post reply');
            }
        }
        
        // Get current open topic ID
        function getCurrentTopicId() {
            const visibleSection = document.querySelector('.topic-discussions[style*="block"]');
            if (visibleSection) {
                return visibleSection.id.replace('-discussions-section', '');
            }
            return null;
        }
        
        // Edit discussion
        async function editDiscussion(discussionId) {
            const newTitle = prompt('Edit question title:');
            const newContent = prompt('Edit question content:');
            
            if (newTitle && newContent) {
                try {
                    const response = await fetch(`http://127.0.0.1:8000/api/community/discussions/${discussionId}/`, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': getCookie('csrftoken')
                        },
                        body: JSON.stringify({ title: newTitle, content: newContent })
                    });
                    
                    if (response.ok) {
                        showSuccessMessage('Question updated successfully!');
                        const topicId = getCurrentTopicId();
                        if (topicId) {
                            await loadTopicDiscussions(topicId);
                        }
                    } else {
                        alert('Failed to update question');
                    }
                } catch (error) {
                    console.error('Error updating question:', error);
                    alert('Failed to update question');
                }
            }
        }
        
        // Delete discussion
        async function deleteDiscussion(discussionId) {
            if (confirm('Are you sure you want to delete this question?')) {
                try {
                    const response = await fetch(`http://127.0.0.1:8000/api/community/discussions/${discussionId}/`, {
                        method: 'DELETE',
                        headers: {
                            'X-CSRFToken': getCookie('csrftoken')
                        }
                    });
                    
                    if (response.ok) {
                        showSuccessMessage('Question deleted successfully!');
                        const topicId = getCurrentTopicId();
                        if (topicId) {
                            await loadTopicDiscussions(topicId);
                            await fetchTopicStats();
                        }
                    } else {
                        alert('Failed to delete question');
                    }
                } catch (error) {
                    console.error('Error deleting question:', error);
                    alert('Failed to delete question');
                }
            }
        }
        
        // Edit reply
        async function editReply(replyId) {
            const newContent = prompt('Edit your reply:');
            
            if (newContent) {
                try {
                    const response = await fetch(`http://127.0.0.1:8000/api/community/replies/${replyId}/`, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': getCookie('csrftoken')
                        },
                        body: JSON.stringify({ content: newContent })
                    });
                    
                    if (response.ok) {
                        showSuccessMessage('Reply updated successfully!');
                        const topicId = getCurrentTopicId();
                        if (topicId) {
                            await loadTopicDiscussions(topicId);
                        }
                    } else {
                        alert('Failed to update reply');
                    }
                } catch (error) {
                    console.error('Error updating reply:', error);
                    alert('Failed to update reply');
                }
            }
        }
        
        // Delete reply
        async function deleteReply(replyId) {
            if (confirm('Are you sure you want to delete this reply?')) {
                try {
                    const response = await fetch(`http://127.0.0.1:8000/api/community/replies/${replyId}/`, {
                        method: 'DELETE',
                        headers: {
                            'X-CSRFToken': getCookie('csrftoken')
                        }
                    });
                    
                    if (response.ok) {
                        showSuccessMessage('Reply deleted successfully!');
                        const topicId = getCurrentTopicId();
                        if (topicId) {
                            await loadTopicDiscussions(topicId);
                            await fetchTopicStats();
                        }
                    } else {
                        alert('Failed to delete reply');
                    }
                } catch (error) {
                    console.error('Error deleting reply:', error);
                    alert('Failed to delete reply');
                }
            }
        }
        
        // Success message function
        function showSuccessMessage(message) {
            const successDiv = document.createElement('div');
            successDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #27ae60;
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                font-weight: 600;
                z-index: 10000;
                box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            `;
            successDiv.textContent = message;
            document.body.appendChild(successDiv);
            
            setTimeout(() => {
                successDiv.remove();
            }, 3000);
        }
        
        // Reply submission
        async function submitReply(event, discussionId) {
            event.preventDefault();
            
            const confirmed = confirm('â ï¸ IMPORTANT NOTICE\n\nPlease review your reply carefully before posting:\n\nâ¢ You CANNOT edit or delete your reply once posted\nâ¢ Make sure there are no spelling or grammar errors\nâ¢ Ensure your reply is helpful and appropriate\n\nDo you want to proceed with posting this reply?');
            
            if (!confirmed) return;
            
            const form = event.target;
            const formData = new FormData(form);
            const content = formData.get('content');
            
            try {
                const response = await fetch(`http://127.0.0.1:8000/api/community/discussions/${discussionId}/replies/`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': getCookie('csrftoken')
                    },
                    body: JSON.stringify({ content })
                });
                
                if (response.ok) {
                    showSuccessMessage('Reply posted successfully!');
                    form.reset();
                    const topicId = getCurrentTopicId();
                    if (topicId) {
                        await loadTopicDiscussions(topicId);
                        await fetchTopicStats(); // Update counts immediately
                    }
                } else {
                    alert('Failed to post reply');
                }
            } catch (error) {
                console.error('Error posting reply:', error);
                alert('Failed to post reply');
            }
        }
        
        function getCurrentTopicId() {
            const visibleSection = document.querySelector('.topic-discussions[style*="block"]');
            if (visibleSection) {
                return visibleSection.id.replace('-discussions-section', '');
            }
            return null;
        }
        
        async function editDiscussion(discussionId) {
            const newTitle = prompt('Edit question title:');
            const newContent = prompt('Edit question content:');
            
            if (newTitle && newContent) {
                try {
                    const response = await fetch(`http://127.0.0.1:8000/api/community/discussions/${discussionId}/`, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': getCookie('csrftoken')
                        },
                        body: JSON.stringify({ title: newTitle, content: newContent })
                    });
                    
                    if (response.ok) {
                        showSuccessMessage('Question updated successfully!');
                        const topicId = getCurrentTopicId();
                        if (topicId) {
                            await loadTopicDiscussions(topicId);
                        }
                    } else {
                        alert('Failed to update question');
                    }
                } catch (error) {
                    alert('Failed to update question');
                }
            }
        }
        
        async function deleteDiscussion(discussionId) {
            if (confirm('Are you sure you want to delete this question?')) {
                try {
                    const response = await fetch(`http://127.0.0.1:8000/api/community/discussions/${discussionId}/`, {
                        method: 'DELETE',
                        headers: {
                            'X-CSRFToken': getCookie('csrftoken')
                        }
                    });
                    
                    if (response.ok) {
                        showSuccessMessage('Question deleted successfully!');
                        const topicId = getCurrentTopicId();
                        if (topicId) {
                            await loadTopicDiscussions(topicId);
                            await fetchTopicStats();
                        }
                    } else {
                        alert('Failed to delete question');
                    }
                } catch (error) {
                    alert('Failed to delete question');
                }
            }
        }
        
        async function editReply(replyId) {
            const newContent = prompt('Edit your reply:');
            
            if (newContent) {
                try {
                    const response = await fetch(`http://127.0.0.1:8000/api/community/replies/${replyId}/`, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': getCookie('csrftoken')
                        },
                        body: JSON.stringify({ content: newContent })
                    });
                    
                    if (response.ok) {
                        showSuccessMessage('Reply updated successfully!');
                        const topicId = getCurrentTopicId();
                        if (topicId) {
                            await loadTopicDiscussions(topicId);
                        }
                    } else {
                        alert('Failed to update reply');
                    }
                } catch (error) {
                    alert('Failed to update reply');
                }
            }
        }
        
        async function deleteReply(replyId) {
            if (confirm('Are you sure you want to delete this reply?')) {
                try {
                    const response = await fetch(`http://127.0.0.1:8000/api/community/replies/${replyId}/`, {
                        method: 'DELETE',
                        headers: {
                            'X-CSRFToken': getCookie('csrftoken')
                        }
                    });
                    
                    if (response.ok) {
                        showSuccessMessage('Reply deleted successfully!');
                        const topicId = getCurrentTopicId();
                        if (topicId) {
                            await loadTopicDiscussions(topicId);
                            await fetchTopicStats();
                        }
                    } else {
                        alert('Failed to delete reply');
                    }
                } catch (error) {
                    alert('Failed to delete reply');
                }
            }
        }
        
        // Toggle replies visibility
        function toggleReplies(discussionId) {
            const hiddenReplies = document.getElementById(`replies-hidden-${discussionId}`);
            const toggleBtn = document.getElementById(`toggle-replies-${discussionId}`);
            
            if (hiddenReplies.style.display === 'none') {
                hiddenReplies.style.display = 'block';
                toggleBtn.innerHTML = '<i class="fas fa-chevron-up" style="margin-right: 5px;"></i> Show less replies';
            } else {
                hiddenReplies.style.display = 'none';
                const hiddenCount = hiddenReplies.children.length;
                toggleBtn.innerHTML = `<i class="fas fa-chevron-down" style="margin-right: 5px;"></i> Show ${hiddenCount} more replies`;
            }
        }
        
        // Back to top functionality
        const backToTopBtn = document.getElementById('backToTopBtn');
        if (backToTopBtn) {
            backToTopBtn.addEventListener('click', function() {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            });
        }
    </script>
</body>
</html>
